2025-08-14 03:19:52,535 - __main__ - INFO - Starting security analysis for alert 1
2025-08-14 03:19:52,535 - __main__ - ERROR - Error loading alert data: [Errno 2] No such file or directory: 'alerts.json'
2025-08-14 03:19:52,536 - __main__ - ERROR - Error in security analysis: [Errno 2] No such file or directory: 'alerts.json'
2025-08-14 03:22:43,693 - __main__ - INFO - Starting security analysis for alert 1
2025-08-14 03:22:43,769 - __main__ - INFO - Executing agent: user_context
2025-08-14 03:22:43,770 - __main__ - ERROR - Error executing agent user_context: string indices must be integers, not 'str'
2025-08-14 03:22:43,770 - __main__ - INFO - Executing agent: ip_agent
2025-08-14 03:22:43,770 - __main__ - INFO - Executing agent: alert_history
2025-08-14 03:22:43,770 - __main__ - ERROR - Error executing agent ip_agent: string indices must be integers, not 'str'
2025-08-14 03:22:43,771 - __main__ - INFO - Parallel agent user_context completed
2025-08-14 03:22:43,771 - __main__ - ERROR - Error executing agent alert_history: string indices must be integers, not 'str'
2025-08-14 03:22:43,771 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 03:22:43,771 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 03:22:43,772 - __main__ - INFO - Executing agent: timeline
2025-08-14 03:22:43,772 - __main__ - ERROR - Error executing agent timeline: string indices must be integers, not 'str'
2025-08-14 03:22:43,772 - __main__ - INFO - Executing agent: summary
2025-08-14 03:22:43,772 - __main__ - ERROR - Error executing agent summary: 'summary'
2025-08-14 03:22:43,773 - __main__ - INFO - Security analysis completed successfully
2025-08-14 03:31:23,283 - __main__ - INFO - Starting security analysis for alert 1
2025-08-14 03:31:23,351 - __main__ - INFO - Executing agent: user_context
2025-08-14 03:31:23,351 - __main__ - ERROR - Error executing agent user_context: string indices must be integers, not 'str'
2025-08-14 03:31:23,351 - __main__ - INFO - Executing agent: ip_agent
2025-08-14 03:31:23,352 - __main__ - INFO - Parallel agent user_context completed
2025-08-14 03:31:23,352 - __main__ - INFO - Executing agent: alert_history
2025-08-14 03:31:23,352 - __main__ - ERROR - Error executing agent ip_agent: string indices must be integers, not 'str'
2025-08-14 03:31:23,352 - __main__ - ERROR - Error executing agent alert_history: string indices must be integers, not 'str'
2025-08-14 03:31:23,352 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 03:31:23,352 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 03:31:23,353 - __main__ - INFO - Executing agent: timeline
2025-08-14 03:31:23,353 - __main__ - ERROR - Error executing agent timeline: string indices must be integers, not 'str'
2025-08-14 03:31:23,353 - __main__ - INFO - Executing agent: summary
2025-08-14 03:31:23,354 - __main__ - ERROR - Error executing agent summary: 'summary'
2025-08-14 03:31:23,354 - __main__ - INFO - Security analysis completed successfully
2025-08-14 03:34:29,436 - __main__ - INFO - Starting security analysis for alert 1
2025-08-14 03:34:29,492 - __main__ - INFO - Executing agent: user_context
2025-08-14 03:34:29,492 - __main__ - ERROR - Error executing agent user_context: string indices must be integers, not 'str'
2025-08-14 03:34:29,493 - __main__ - INFO - Executing agent: ip_agent
2025-08-14 03:34:29,493 - __main__ - INFO - Parallel agent user_context completed
2025-08-14 03:34:29,493 - __main__ - INFO - Executing agent: alert_history
2025-08-14 03:34:29,493 - __main__ - ERROR - Error executing agent ip_agent: string indices must be integers, not 'str'
2025-08-14 03:34:29,493 - __main__ - ERROR - Error executing agent alert_history: string indices must be integers, not 'str'
2025-08-14 03:34:29,493 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 03:34:29,494 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 03:34:29,494 - __main__ - INFO - Executing agent: timeline
2025-08-14 03:34:29,494 - __main__ - ERROR - Error executing agent timeline: string indices must be integers, not 'str'
2025-08-14 03:34:29,495 - __main__ - INFO - Executing agent: summary
2025-08-14 03:34:29,495 - __main__ - ERROR - Error executing agent summary: 'summary'
2025-08-14 03:34:29,495 - __main__ - INFO - Security analysis completed successfully
2025-08-14 03:39:50,517 - __main__ - INFO - Starting security analysis for alert 1
2025-08-14 03:39:50,518 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-14 03:39:50,576 - __main__ - INFO - Orchestration planned: 5 agents
2025-08-14 03:39:50,577 - __main__ - INFO - Executing agent: user_context
2025-08-14 03:39:50,577 - __main__ - INFO - Executing agent: ip_agent
2025-08-14 03:39:50,578 - __main__ - INFO - Executing agent: alert_history
2025-08-14 03:40:39,433 - __main__ - INFO - Agent user_context completed successfully
2025-08-14 03:40:39,434 - __main__ - INFO - Parallel agent user_context completed
2025-08-14 03:40:55,696 - __main__ - INFO - Agent alert_history completed successfully
2025-08-14 03:40:55,697 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 03:40:55,772 - __main__ - INFO - Agent ip_agent completed successfully
2025-08-14 03:40:55,772 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 03:40:55,780 - __main__ - INFO - Executing agent: timeline
2025-08-14 03:41:44,543 - __main__ - INFO - Agent timeline completed successfully
2025-08-14 03:41:44,543 - __main__ - INFO - Executing agent: summary
2025-08-14 03:41:44,544 - __main__ - INFO - Agent summary completed successfully
2025-08-14 03:41:44,544 - __main__ - INFO - Security analysis completed successfully
2025-08-14 12:10:52,193 - __main__ - INFO - Starting security analysis for alert 1
2025-08-14 12:10:52,194 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-14 12:10:52,253 - __main__ - INFO - Orchestration planned: 5 agents
2025-08-14 12:10:52,254 - __main__ - INFO - Executing agent: user_context
2025-08-14 12:10:52,254 - __main__ - INFO - Executing agent: ip_agent
2025-08-14 12:10:52,255 - __main__ - INFO - Executing agent: alert_history
2025-08-14 12:11:41,121 - __main__ - INFO - Agent user_context completed successfully
2025-08-14 12:11:41,121 - __main__ - INFO - Parallel agent user_context completed
2025-08-14 12:11:57,451 - __main__ - INFO - Agent alert_history completed successfully
2025-08-14 12:11:57,451 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 12:11:57,517 - __main__ - INFO - Agent ip_agent completed successfully
2025-08-14 12:11:57,517 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 12:11:57,519 - __main__ - INFO - Executing agent: timeline
2025-08-14 12:12:46,320 - __main__ - INFO - Agent timeline completed successfully
2025-08-14 12:12:46,321 - __main__ - INFO - Executing agent: summary
2025-08-14 12:12:46,321 - __main__ - INFO - Agent summary completed successfully
2025-08-14 12:12:46,321 - __main__ - INFO - Security analysis completed successfully
2025-08-14 12:14:51,896 - __main__ - INFO - Starting security analysis for alert 1
2025-08-14 12:14:51,897 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-14 12:14:51,958 - __main__ - INFO - Orchestration planned: 5 agents
2025-08-14 12:14:51,959 - __main__ - INFO - Executing agent: user_context
2025-08-14 12:14:51,959 - __main__ - INFO - Executing agent: ip_agent
2025-08-14 12:14:51,960 - __main__ - INFO - Executing agent: alert_history
2025-08-14 12:15:40,825 - __main__ - INFO - Agent user_context completed successfully
2025-08-14 12:15:40,826 - __main__ - INFO - Parallel agent user_context completed
2025-08-14 12:15:57,032 - __main__ - INFO - Agent ip_agent completed successfully
2025-08-14 12:15:57,032 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 12:15:57,146 - __main__ - INFO - Agent alert_history completed successfully
2025-08-14 12:15:57,146 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 12:15:57,147 - __main__ - INFO - Executing agent: timeline
2025-08-14 12:16:46,060 - __main__ - INFO - Agent timeline completed successfully
2025-08-14 12:16:46,061 - __main__ - INFO - Executing agent: summary
2025-08-14 12:16:46,061 - __main__ - INFO - Agent summary completed successfully
2025-08-14 12:16:46,061 - __main__ - INFO - Security analysis completed successfully
2025-08-14 12:40:40,910 - __main__ - INFO - Starting security analysis for alert 15
2025-08-14 12:40:40,911 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 12:40:40,976 - __main__ - INFO - Orchestration planned: 5 agents
2025-08-14 12:40:40,977 - __main__ - INFO - Executing agent: user_context
2025-08-14 12:40:40,978 - __main__ - INFO - Executing agent: ip_agent
2025-08-14 12:40:40,979 - __main__ - INFO - Executing agent: alert_history
2025-08-14 12:41:29,938 - __main__ - INFO - Agent user_context completed successfully
2025-08-14 12:41:29,938 - __main__ - INFO - Parallel agent user_context completed
2025-08-14 12:41:46,228 - __main__ - INFO - Agent alert_history completed successfully
2025-08-14 12:41:46,229 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 12:41:46,244 - __main__ - INFO - Agent ip_agent completed successfully
2025-08-14 12:41:46,244 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 12:41:46,245 - __main__ - INFO - Executing agent: timeline
2025-08-14 12:42:35,216 - __main__ - INFO - Agent timeline completed successfully
2025-08-14 12:42:35,216 - __main__ - INFO - Executing agent: summary
2025-08-14 12:42:35,216 - __main__ - INFO - Agent summary completed successfully
2025-08-14 12:42:35,216 - __main__ - INFO - Security analysis completed successfully
2025-08-14 12:48:56,891 - __main__ - INFO - Starting security analysis for alert 15
2025-08-14 12:48:56,891 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 12:48:56,949 - __main__ - INFO - Orchestration planned: 5 agents
2025-08-14 12:48:56,950 - __main__ - INFO - Executing agent: user_context
2025-08-14 12:48:56,950 - __main__ - INFO - Executing agent: ip_agent
2025-08-14 12:48:56,951 - __main__ - INFO - Executing agent: alert_history
2025-08-14 12:49:45,798 - __main__ - INFO - Agent user_context completed successfully
2025-08-14 12:49:45,799 - __main__ - INFO - Parallel agent user_context completed
2025-08-14 12:50:02,040 - __main__ - INFO - Agent alert_history completed successfully
2025-08-14 12:50:02,040 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 12:50:02,113 - __main__ - INFO - Agent ip_agent completed successfully
2025-08-14 12:50:02,114 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 12:50:02,115 - __main__ - INFO - Executing agent: timeline
2025-08-14 12:50:50,914 - __main__ - INFO - Agent timeline completed successfully
2025-08-14 12:50:50,915 - __main__ - INFO - Executing agent: summary
2025-08-14 12:50:50,915 - __main__ - INFO - Agent summary completed successfully
2025-08-14 12:50:50,915 - __main__ - INFO - Security analysis completed successfully
2025-08-14 13:05:15,470 - __main__ - INFO - Starting security analysis for alert 8
2025-08-14 13:05:15,471 - __main__ - INFO - Loaded alert: Network Share Accessed
2025-08-14 13:05:15,535 - __main__ - INFO - Orchestration planned: 5 agents
2025-08-14 13:05:15,536 - __main__ - INFO - Executing agent: user_context
2025-08-14 13:05:15,536 - __main__ - INFO - Executing agent: ip_agent
2025-08-14 13:05:15,537 - __main__ - INFO - Executing agent: alert_history
2025-08-14 13:06:04,503 - __main__ - INFO - Agent user_context completed successfully
2025-08-14 13:06:04,505 - __main__ - INFO - Parallel agent user_context completed
2025-08-14 13:06:20,765 - __main__ - INFO - Agent ip_agent completed successfully
2025-08-14 13:06:20,766 - __main__ - INFO - Agent alert_history completed successfully
2025-08-14 13:06:20,766 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 13:06:20,766 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 13:06:20,768 - __main__ - INFO - Executing agent: timeline
2025-08-14 13:07:09,663 - __main__ - INFO - Agent timeline completed successfully
2025-08-14 13:07:09,663 - __main__ - INFO - Executing agent: summary
2025-08-14 13:07:09,663 - __main__ - INFO - Agent summary completed successfully
2025-08-14 13:07:09,664 - __main__ - INFO - Security analysis completed successfully
2025-08-14 13:07:58,944 - __main__ - INFO - Starting security analysis for alert 15
2025-08-14 13:07:58,945 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 13:07:59,005 - __main__ - INFO - Orchestration planned: 5 agents
2025-08-14 13:07:59,006 - __main__ - INFO - Executing agent: user_context
2025-08-14 13:07:59,006 - __main__ - INFO - Executing agent: ip_agent
2025-08-14 13:07:59,007 - __main__ - INFO - Executing agent: alert_history
2025-08-14 13:08:47,964 - __main__ - INFO - Agent user_context completed successfully
2025-08-14 13:08:47,965 - __main__ - INFO - Parallel agent user_context completed
2025-08-14 13:09:04,231 - __main__ - INFO - Agent ip_agent completed successfully
2025-08-14 13:09:04,232 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 13:09:04,309 - __main__ - INFO - Agent alert_history completed successfully
2025-08-14 13:09:04,310 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 13:09:04,311 - __main__ - INFO - Executing agent: timeline
2025-08-14 13:09:53,231 - __main__ - INFO - Agent timeline completed successfully
2025-08-14 13:09:53,231 - __main__ - INFO - Executing agent: summary
2025-08-14 13:09:53,232 - __main__ - INFO - Agent summary completed successfully
2025-08-14 13:09:53,232 - __main__ - INFO - Security analysis completed successfully
2025-08-14 13:21:56,985 - __main__ - INFO - Starting security analysis for alert 15
2025-08-14 13:21:56,986 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 13:21:56,987 - __main__ - INFO - Orchestration planned: 2 agents
2025-08-14 13:21:56,987 - __main__ - INFO - Executing agent: ip_agent
2025-08-14 13:23:01,845 - __main__ - INFO - Agent ip_agent completed successfully
2025-08-14 13:23:01,846 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 13:23:01,846 - __main__ - INFO - Executing agent: summary
2025-08-14 13:23:01,847 - __main__ - INFO - Agent summary completed successfully
2025-08-14 13:23:01,847 - __main__ - INFO - Security analysis completed successfully
2025-08-14 13:43:21,510 - __main__ - INFO - Starting security analysis for alert 15
2025-08-14 13:43:21,511 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 13:43:21,512 - __main__ - INFO - Orchestration planned: 5 agents
2025-08-14 13:43:21,513 - __main__ - INFO - Executing agent: alert_history
2025-08-14 13:43:21,513 - __main__ - INFO - Executing agent: user_context
2025-08-14 13:43:21,515 - __main__ - INFO - Executing agent: ip_agent
2025-08-14 13:44:10,450 - __main__ - INFO - Agent user_context completed successfully
2025-08-14 13:44:10,451 - __main__ - INFO - Parallel agent user_context completed
2025-08-14 13:44:26,755 - __main__ - INFO - Agent alert_history completed successfully
2025-08-14 13:44:26,755 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 13:44:26,771 - __main__ - INFO - Agent ip_agent completed successfully
2025-08-14 13:44:26,772 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 13:44:26,773 - __main__ - INFO - Executing agent: summary
2025-08-14 13:44:26,773 - __main__ - INFO - Agent summary completed successfully
2025-08-14 13:44:26,773 - __main__ - INFO - Executing agent: timeline
2025-08-14 13:45:15,663 - __main__ - INFO - Agent timeline completed successfully
2025-08-14 13:45:15,663 - __main__ - INFO - Security analysis completed successfully
2025-08-14 13:49:15,851 - __main__ - INFO - Starting security analysis for alert 10
2025-08-14 13:49:15,852 - __main__ - INFO - Loaded alert: Detailed Share Access
2025-08-14 13:49:15,853 - __main__ - INFO - Orchestration planned: 1 agents
2025-08-14 13:49:15,853 - __main__ - INFO - Executing agent: summary
2025-08-14 13:49:15,854 - __main__ - INFO - Agent summary completed successfully
2025-08-14 13:49:15,854 - __main__ - INFO - Security analysis completed successfully
2025-08-14 13:53:55,514 - __main__ - INFO - Starting security analysis for alert 15
2025-08-14 13:53:55,515 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 13:53:55,516 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-14 13:53:55,516 - __main__ - INFO - Executing agent: alert_history
2025-08-14 13:53:55,517 - __main__ - INFO - Executing agent: ip_agent
2025-08-14 13:55:00,629 - __main__ - INFO - Agent alert_history completed successfully
2025-08-14 13:55:00,630 - __main__ - INFO - Agent ip_agent completed successfully
2025-08-14 13:55:00,630 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 13:55:00,630 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 13:55:00,631 - __main__ - INFO - Executing agent: summary
2025-08-14 13:55:00,632 - __main__ - INFO - Agent summary completed successfully
2025-08-14 13:55:00,632 - __main__ - INFO - Executing agent: timeline
2025-08-14 13:55:49,563 - __main__ - INFO - Agent timeline completed successfully
2025-08-14 13:55:49,564 - __main__ - INFO - Security analysis completed successfully
2025-08-14 14:04:41,082 - __main__ - INFO - Starting security analysis for alert 15
2025-08-14 14:04:41,083 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 14:04:41,084 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-14 14:04:41,084 - __main__ - INFO - Executing agent: alert_history
2025-08-14 14:04:41,085 - __main__ - INFO - Executing agent: user_context
2025-08-14 14:05:29,842 - __main__ - INFO - Agent user_context completed successfully
2025-08-14 14:05:29,842 - __main__ - INFO - Parallel agent user_context completed
2025-08-14 14:05:46,015 - __main__ - INFO - Agent alert_history completed successfully
2025-08-14 14:11:04,574 - __main__ - INFO - Starting security analysis for alert 15
2025-08-14 14:11:04,575 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 14:11:04,575 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-14 14:11:04,576 - __main__ - INFO - Executing agent: alert_history
2025-08-14 14:11:04,577 - __main__ - INFO - Executing agent: ip_agent
2025-08-14 14:12:09,717 - __main__ - INFO - Agent alert_history completed successfully
2025-08-14 14:12:09,718 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 14:12:09,745 - __main__ - INFO - Agent ip_agent completed successfully
2025-08-14 14:12:09,746 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 14:12:09,747 - __main__ - INFO - Executing agent: summary
2025-08-14 14:12:09,747 - __main__ - INFO - Agent summary completed successfully
2025-08-14 14:12:09,747 - __main__ - INFO - Executing agent: timeline
2025-08-14 14:12:58,601 - __main__ - INFO - Agent timeline completed successfully
2025-08-14 14:12:58,602 - __main__ - INFO - Security analysis completed successfully
2025-08-14 14:37:34,155 - __main__ - INFO - Starting integrated security analysis for alert 1
2025-08-14 14:37:34,155 - __main__ - INFO - Initializing ES Query Builder with events file: C:\Users\ADMIN\Downloads\Spharaka-Windows_Events_Filtered.json
2025-08-14 14:37:38,617 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-14 14:37:38,617 - __main__ - INFO - Processing files using ES Query Builder
2025-08-14 14:37:38,617 - __main__ - INFO - Loaded 20 alerts from C:\Users\ADMIN\Desktop\latest\alerts.jsonl
2025-08-14 14:37:38,618 - __main__ - INFO - Selected alert: Explicit Credential Logon Attempt
2025-08-14 14:37:39,482 - __main__ - INFO - Loaded 58770 data entries from C:\Users\ADMIN\Desktop\latest\data.json
2025-08-14 14:37:39,482 - __main__ - INFO - Alert info extracted: event_ids=['b3866106-621f-4ad7-90bd-b2e2a5f0e694']
2025-08-14 14:37:39,482 - __main__ - INFO - Found matching data entry
2025-08-14 14:37:39,483 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-14 14:37:39,483 - __main__ - INFO - Generating Elasticsearch queries
2025-08-14 14:37:39,554 - __main__ - INFO - Generated queries successfully. Found 5 relevant events
2025-08-14 14:37:39,554 - __main__ - INFO - Generated Elasticsearch queries
2025-08-14 14:37:39,555 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-14 14:37:39,556 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-14 14:37:39,557 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-14 14:38:44,688 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-14 14:38:44,689 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 14:38:44,726 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-14 14:38:44,726 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 14:38:44,728 - __main__ - INFO - Executing agent: summary with ES context
2025-08-14 14:38:44,728 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-14 14:38:44,728 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-14 14:39:33,522 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-14 14:39:33,522 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-14 14:42:04,685 - __main__ - INFO - Starting integrated security analysis for alert 2
2025-08-14 14:42:04,685 - __main__ - INFO - Initializing ES Query Builder with events file: C:\Users\ADMIN\Downloads\Spharaka-Windows_Events_Filtered.json
2025-08-14 14:42:08,329 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-14 14:42:08,329 - __main__ - INFO - Processing files using ES Query Builder
2025-08-14 14:42:08,330 - __main__ - INFO - Loaded 20 alerts from C:\Users\ADMIN\Desktop\latest\alerts.jsonl
2025-08-14 14:42:08,330 - __main__ - INFO - Selected alert: Object Permissions Changed
2025-08-14 14:42:09,173 - __main__ - INFO - Loaded 58770 data entries from C:\Users\ADMIN\Desktop\latest\data.json
2025-08-14 14:42:09,173 - __main__ - INFO - Alert info extracted: event_ids=['a61149e1-94e5-4f46-a842-e552aa53f55a']
2025-08-14 14:42:09,173 - __main__ - INFO - Found matching data entry
2025-08-14 14:42:09,174 - __main__ - INFO - Loaded alert: Object Permissions Changed
2025-08-14 14:42:09,174 - __main__ - INFO - Generating Elasticsearch queries
2025-08-14 14:42:09,242 - __main__ - INFO - Generated queries successfully. Found 5 relevant events
2025-08-14 14:42:09,242 - __main__ - INFO - Generated Elasticsearch queries
2025-08-14 14:42:09,243 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-14 14:42:09,244 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-14 14:42:09,244 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-14 14:42:58,031 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-14 14:42:58,032 - __main__ - INFO - Parallel agent user_context completed
2025-08-14 14:43:14,222 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-14 14:43:14,223 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 14:43:14,224 - __main__ - INFO - Executing agent: summary with ES context
2025-08-14 14:43:14,225 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-14 14:43:14,225 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-14 14:44:02,935 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-14 14:44:02,935 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-14 14:47:18,879 - __main__ - INFO - Starting integrated security analysis for alert 1
2025-08-14 14:47:18,879 - __main__ - INFO - Initializing ES Query Builder with events file: C:\Users\ADMIN\Downloads\Spharaka-Windows_Events_Filtered.json
2025-08-14 14:47:22,707 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-14 14:47:22,707 - __main__ - INFO - Processing files using ES Query Builder
2025-08-14 14:47:22,708 - __main__ - INFO - Loaded 20 alerts from C:\Users\ADMIN\Desktop\latest\alerts.jsonl
2025-08-14 14:47:22,708 - __main__ - INFO - Selected alert: Explicit Credential Logon Attempt
2025-08-14 14:47:23,507 - __main__ - INFO - Loaded 58770 data entries from C:\Users\ADMIN\Desktop\latest\data.json
2025-08-14 14:47:23,507 - __main__ - INFO - Alert info extracted: event_ids=['b3866106-621f-4ad7-90bd-b2e2a5f0e694']
2025-08-14 14:47:23,507 - __main__ - INFO - Found matching data entry
2025-08-14 14:47:23,507 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-14 14:47:23,508 - __main__ - INFO - Generating Elasticsearch queries
2025-08-14 14:47:23,583 - __main__ - INFO - Generated queries successfully. Found 7 relevant events
2025-08-14 14:47:23,583 - __main__ - INFO - Generated Elasticsearch queries
2025-08-14 14:47:23,584 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-14 14:47:23,585 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-14 14:47:23,585 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-14 14:48:12,466 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-14 14:48:12,466 - __main__ - INFO - Parallel agent user_context completed
2025-08-14 14:48:28,756 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-14 14:48:28,756 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 14:48:28,757 - __main__ - INFO - Executing agent: summary with ES context
2025-08-14 14:48:28,758 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-14 14:48:28,758 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-14 14:49:17,623 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-14 14:49:17,623 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-14 17:52:08,050 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-14 17:52:08,050 - __main__ - INFO - Initializing ES Query Builder with events file: C:\Users\ADMIN\Desktop\latest\Spharaka-Windows_Events_Filtered.json
2025-08-14 17:52:12,690 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-14 17:52:12,690 - __main__ - INFO - Processing files using ES Query Builder
2025-08-14 17:52:12,692 - __main__ - INFO - Loaded 20 alerts from C:\Users\ADMIN\Desktop\latest\alerts.jsonl
2025-08-14 17:52:12,692 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-14 17:52:13,551 - __main__ - INFO - Loaded 58770 data entries from C:\Users\ADMIN\Desktop\latest\data.json
2025-08-14 17:52:13,551 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-14 17:52:13,552 - __main__ - INFO - Found matching data entry
2025-08-14 17:52:13,552 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 17:52:13,552 - __main__ - INFO - Generating Elasticsearch queries
2025-08-14 17:52:13,626 - __main__ - INFO - Generated queries successfully. Found 5 relevant events
2025-08-14 17:52:13,626 - __main__ - INFO - Generated Elasticsearch queries
2025-08-14 17:52:13,627 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-14 17:52:13,628 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-14 17:52:13,628 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-14 17:53:02,199 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-14 17:53:02,199 - __main__ - INFO - Parallel agent user_context completed
2025-08-14 17:53:18,414 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-14 17:53:18,415 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 17:53:18,422 - __main__ - INFO - Executing agent: summary with ES context
2025-08-14 17:53:18,422 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-14 17:53:18,423 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-14 17:54:07,039 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-14 17:54:07,040 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-14 18:06:38,483 - __main__ - INFO - Starting integrated security analysis for alert 12
2025-08-14 18:06:38,483 - __main__ - INFO - Initializing ES Query Builder with events file: C:\Users\ADMIN\Desktop\latest\Spharaka-Windows_Events_Filtered.json
2025-08-14 18:06:42,258 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-14 18:06:42,258 - __main__ - INFO - Processing files using ES Query Builder
2025-08-14 18:06:42,259 - __main__ - INFO - Loaded 20 alerts from C:\Users\ADMIN\Desktop\latest\alerts.jsonl
2025-08-14 18:06:42,259 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-14 18:06:43,123 - __main__ - INFO - Loaded 58770 data entries from C:\Users\ADMIN\Desktop\latest\data.json
2025-08-14 18:06:43,123 - __main__ - INFO - Alert info extracted: event_ids=['12345cf6-f93d-40b2-a224-e9081c80e2c6']
2025-08-14 18:06:43,124 - __main__ - INFO - Found matching data entry
2025-08-14 18:06:43,124 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 18:06:43,124 - __main__ - INFO - Generating Elasticsearch queries
2025-08-14 18:06:43,189 - __main__ - INFO - Generated queries successfully. Found 5 relevant events
2025-08-14 18:06:43,189 - __main__ - INFO - Generated Elasticsearch queries
2025-08-14 18:06:43,190 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-14 18:06:43,191 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-14 18:06:43,191 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-14 18:07:32,040 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-14 18:07:32,041 - __main__ - INFO - Parallel agent user_context completed
2025-08-14 18:07:48,415 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-14 18:07:48,416 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 18:07:48,417 - __main__ - INFO - Executing agent: summary with ES context
2025-08-14 18:07:48,417 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-14 18:07:48,417 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-14 18:08:37,182 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-14 18:08:37,183 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-14 18:29:24,220 - __main__ - INFO - Starting integrated security analysis for alert 2
2025-08-14 18:29:24,221 - __main__ - INFO - Initializing ES Query Builder with events file: C:\Users\ADMIN\Desktop\latest\Spharaka-Windows_Events_Filtered.json
2025-08-14 18:29:28,419 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-14 18:29:28,420 - __main__ - INFO - Processing files using ES Query Builder
2025-08-14 18:29:28,420 - __main__ - INFO - Loaded 20 alerts from C:\Users\ADMIN\Desktop\latest\alerts.jsonl
2025-08-14 18:29:28,420 - __main__ - INFO - Selected alert: Object Permissions Changed
2025-08-14 18:29:29,233 - __main__ - INFO - Loaded 58770 data entries from C:\Users\ADMIN\Desktop\latest\data.json
2025-08-14 18:29:29,234 - __main__ - INFO - Alert info extracted: event_ids=['a61149e1-94e5-4f46-a842-e552aa53f55a']
2025-08-14 18:29:29,234 - __main__ - INFO - Found matching data entry
2025-08-14 18:29:29,234 - __main__ - INFO - Loaded alert: Object Permissions Changed
2025-08-14 18:29:29,234 - __main__ - INFO - Generating Elasticsearch queries
2025-08-14 18:29:29,307 - __main__ - INFO - Generated queries successfully. Found 5 relevant events
2025-08-14 18:29:29,307 - __main__ - INFO - Generated Elasticsearch queries
2025-08-14 18:29:29,308 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-14 18:29:29,309 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-14 18:29:29,309 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-14 18:30:17,958 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-14 18:30:17,959 - __main__ - INFO - Parallel agent user_context completed
2025-08-14 18:30:34,164 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-14 18:30:34,164 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 18:30:34,165 - __main__ - INFO - Executing agent: summary with ES context
2025-08-14 18:30:34,166 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-14 18:30:34,166 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-14 18:31:22,994 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-14 18:31:22,994 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-14 21:41:12,522 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-14 21:41:12,529 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-14 21:41:12,530 - main_orchestrator - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-14 21:41:22,154 - main_orchestrator - INFO - Starting integrated security analysis for alert 1
2025-08-14 21:41:22,154 - main_orchestrator - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-14 21:41:28,239 - main_orchestrator - INFO - ES Query Builder initialized successfully
2025-08-14 21:41:28,239 - main_orchestrator - INFO - Processing files using ES Query Builder
2025-08-14 21:41:28,240 - main_orchestrator - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-14 21:41:28,241 - main_orchestrator - INFO - Selected alert: Explicit Credential Logon Attempt
2025-08-14 21:41:29,540 - main_orchestrator - INFO - Loaded 58770 data entries from data.json
2025-08-14 21:41:29,540 - main_orchestrator - INFO - Alert info extracted: event_ids=['b3866106-621f-4ad7-90bd-b2e2a5f0e694']
2025-08-14 21:41:29,541 - main_orchestrator - INFO - Found matching data entry
2025-08-14 21:41:29,541 - main_orchestrator - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-14 21:41:29,541 - main_orchestrator - INFO - Generating Elasticsearch queries
2025-08-14 21:41:30,177 - main_orchestrator - INFO - 🔍 IP Behavior query detected for IPs: ['10.0.0.1']
2025-08-14 21:41:30,177 - main_orchestrator - INFO - Generated queries successfully
2025-08-14 21:41:30,178 - main_orchestrator - INFO - Generated Elasticsearch queries
2025-08-14 21:41:30,179 - main_orchestrator - INFO - 🎯 IP Behavior routing active: focusing on IPs 10.0.0.1
2025-08-14 21:41:30,179 - main_orchestrator - INFO - Orchestration planned: 4 agents
2025-08-14 21:41:30,186 - main_orchestrator - INFO - Executing agent: alert_history with ES context
2025-08-14 21:41:30,188 - main_orchestrator - INFO - Executing agent: ip_agent with ES context
2025-08-14 21:42:35,439 - main_orchestrator - INFO - Agent alert_history completed successfully with ES context
2025-08-14 21:42:35,439 - main_orchestrator - INFO - Parallel agent alert_history completed
2025-08-14 21:42:35,463 - main_orchestrator - INFO - Agent ip_agent completed successfully with ES context
2025-08-14 21:42:35,464 - main_orchestrator - INFO - Parallel agent ip_agent completed
2025-08-14 21:42:35,467 - main_orchestrator - INFO - Executing agent: summary with ES context
2025-08-14 21:42:35,467 - main_orchestrator - INFO - Agent summary completed successfully with ES context
2025-08-14 21:42:35,468 - main_orchestrator - INFO - Executing agent: timeline with ES context
2025-08-14 21:43:24,574 - main_orchestrator - INFO - Agent timeline completed successfully with ES context
2025-08-14 21:43:24,575 - main_orchestrator - INFO - Integrated security analysis completed successfully
2025-08-14 21:43:55,918 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-14 21:43:55,918 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-14 21:43:55,919 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-14 21:44:05,880 - __main__ - INFO - Starting integrated security analysis for alert 1
2025-08-14 21:44:05,880 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-14 21:44:11,653 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-14 21:44:11,654 - __main__ - INFO - Processing files using ES Query Builder
2025-08-14 21:44:11,655 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-14 21:44:11,655 - __main__ - INFO - Selected alert: Explicit Credential Logon Attempt
2025-08-14 21:44:12,868 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-14 21:44:12,869 - __main__ - INFO - Alert info extracted: event_ids=['b3866106-621f-4ad7-90bd-b2e2a5f0e694']
2025-08-14 21:44:12,869 - __main__ - INFO - Found matching data entry
2025-08-14 21:44:12,869 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-14 21:44:12,870 - __main__ - INFO - Generating Elasticsearch queries
2025-08-14 21:44:13,502 - __main__ - INFO - 🔍 IP Behavior query detected for IPs: ['10.0.0.1']
2025-08-14 21:44:13,504 - __main__ - INFO - Generated queries successfully
2025-08-14 21:44:13,504 - __main__ - INFO - Generated Elasticsearch queries
2025-08-14 21:44:13,505 - __main__ - INFO - 🎯 IP Behavior routing active: focusing on IPs 10.0.0.1
2025-08-14 21:44:13,505 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-14 21:44:13,507 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-14 21:44:13,507 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-14 21:45:18,749 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-14 21:45:18,750 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 21:45:18,829 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-14 21:45:18,830 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 21:45:18,832 - __main__ - INFO - Executing agent: summary with ES context
2025-08-14 21:45:18,833 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-14 21:45:18,834 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-14 21:46:07,859 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-14 21:46:07,860 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-14 22:00:39,189 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-14 22:00:39,190 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-14 22:00:39,190 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-14 22:00:55,407 - __main__ - INFO - Starting integrated security analysis for alert 1
2025-08-14 22:00:55,407 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-14 22:01:02,208 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-14 22:01:02,209 - __main__ - INFO - Processing files using ES Query Builder
2025-08-14 22:01:02,210 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-14 22:01:02,210 - __main__ - INFO - Selected alert: Explicit Credential Logon Attempt
2025-08-14 22:01:03,374 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-14 22:01:03,375 - __main__ - INFO - Alert info extracted: event_ids=['b3866106-621f-4ad7-90bd-b2e2a5f0e694']
2025-08-14 22:01:03,375 - __main__ - INFO - Found matching data entry
2025-08-14 22:01:03,375 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-14 22:01:03,376 - __main__ - INFO - Generating Elasticsearch queries
2025-08-14 22:01:03,980 - __main__ - INFO - 🔍 IP Behavior query detected for IPs: ['10.0.0.1']
2025-08-14 22:01:03,981 - __main__ - INFO - Generated queries successfully
2025-08-14 22:01:03,981 - __main__ - INFO - Generated Elasticsearch queries
2025-08-14 22:01:03,982 - __main__ - INFO - 🎯 IP Behavior routing active: focusing on IPs 10.0.0.1
2025-08-14 22:01:03,982 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-14 22:01:03,983 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-14 22:01:03,984 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-14 22:02:09,279 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-14 22:02:09,280 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 22:02:09,527 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-14 22:02:09,527 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 22:02:09,530 - __main__ - INFO - Executing agent: summary with ES context
2025-08-14 22:02:09,530 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-14 22:02:09,530 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-14 22:02:58,634 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-14 22:02:58,635 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-14 22:13:20,791 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-14 22:13:20,792 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-14 22:13:20,792 - main_orchestrator - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-14 22:14:28,833 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-14 22:14:28,834 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-14 22:14:28,834 - main_orchestrator - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-14 22:14:35,647 - main_orchestrator - INFO - Starting integrated security analysis for alert 15
2025-08-14 22:14:35,647 - main_orchestrator - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-14 22:14:39,518 - main_orchestrator - INFO - ES Query Builder initialized successfully
2025-08-14 22:14:39,519 - main_orchestrator - INFO - Processing files using ES Query Builder
2025-08-14 22:14:39,519 - main_orchestrator - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-14 22:14:39,519 - main_orchestrator - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-14 22:14:40,379 - main_orchestrator - INFO - Loaded 58770 data entries from data.json
2025-08-14 22:14:40,380 - main_orchestrator - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-14 22:14:40,380 - main_orchestrator - INFO - Found matching data entry
2025-08-14 22:14:40,380 - main_orchestrator - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 22:14:40,380 - main_orchestrator - INFO - Generating Elasticsearch queries
2025-08-14 22:14:40,728 - main_orchestrator - INFO - 🔍 IP Behavior query detected for IPs: ['192.168.1.104']
2025-08-14 22:14:40,729 - main_orchestrator - INFO - Generated queries successfully
2025-08-14 22:14:40,729 - main_orchestrator - INFO - Generated Elasticsearch queries
2025-08-14 22:14:40,730 - main_orchestrator - INFO - 🎯 IP Behavior routing active: focusing on IPs 192.168.1.104
2025-08-14 22:14:40,730 - main_orchestrator - INFO - Orchestration planned: 4 agents
2025-08-14 22:14:40,731 - main_orchestrator - INFO - Executing agent: alert_history with ES context
2025-08-14 22:14:40,731 - main_orchestrator - INFO - Executing agent: ip_agent with ES context
2025-08-14 22:15:45,707 - main_orchestrator - INFO - Agent alert_history completed successfully with ES context
2025-08-14 22:15:45,708 - main_orchestrator - INFO - Parallel agent alert_history completed
2025-08-14 22:15:45,888 - main_orchestrator - INFO - Agent ip_agent completed successfully with ES context
2025-08-14 22:15:45,888 - main_orchestrator - INFO - Parallel agent ip_agent completed
2025-08-14 22:15:45,889 - main_orchestrator - INFO - Executing agent: summary with ES context
2025-08-14 22:15:45,890 - main_orchestrator - INFO - Agent summary completed successfully with ES context
2025-08-14 22:15:45,890 - main_orchestrator - INFO - Executing agent: timeline with ES context
2025-08-14 22:16:34,831 - main_orchestrator - INFO - Agent timeline completed successfully with ES context
2025-08-14 22:16:34,831 - main_orchestrator - INFO - Integrated security analysis completed successfully
2025-08-14 22:19:57,127 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-14 22:19:57,128 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-14 22:19:57,128 - main_orchestrator - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-14 22:21:41,513 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-14 22:21:41,514 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-14 22:21:41,514 - main_orchestrator - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-14 22:54:32,344 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-14 22:54:32,344 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-14 22:54:32,344 - main_orchestrator - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-14 22:54:40,091 - main_orchestrator - INFO - Starting integrated security analysis for alert 15
2025-08-14 22:54:40,091 - main_orchestrator - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-14 22:54:44,315 - main_orchestrator - INFO - ES Query Builder initialized successfully
2025-08-14 22:54:44,316 - main_orchestrator - INFO - Processing files using ES Query Builder
2025-08-14 22:54:44,316 - main_orchestrator - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-14 22:54:44,316 - main_orchestrator - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-14 22:54:45,189 - main_orchestrator - INFO - Loaded 58770 data entries from data.json
2025-08-14 22:54:45,190 - main_orchestrator - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-14 22:54:45,190 - main_orchestrator - INFO - Found matching data entry
2025-08-14 22:54:45,190 - main_orchestrator - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 22:54:45,191 - main_orchestrator - INFO - Generating Elasticsearch queries
2025-08-14 22:54:45,532 - main_orchestrator - INFO - 🔍 IP Behavior query detected for IPs: ['192.168.1.104']
2025-08-14 22:54:45,533 - main_orchestrator - ERROR - Error generating Elasticsearch queries: 'DynamicConfigSystem' object has no attribute 'config_data'
2025-08-14 22:54:45,533 - main_orchestrator - ERROR - Error in integrated security analysis: 'DynamicConfigSystem' object has no attribute 'config_data'
2025-08-14 22:54:45,534 - main_orchestrator - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\ADMIN\Desktop\latest\main_orchestrator.py", line 774, in analyze_security_alert_integrated
    es_query_result = self.generate_elasticsearch_queries(alert, data_entry, user_prompt)
  File "C:\Users\ADMIN\Desktop\latest\main_orchestrator.py", line 265, in generate_elasticsearch_queries
    enable_semantic = config.config_data.get('semantic', {}).get('enable_for_ip_behavior', True)
                      ^^^^^^^^^^^^^^^^^^
AttributeError: 'DynamicConfigSystem' object has no attribute 'config_data'

2025-08-14 22:56:31,487 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-14 22:56:31,487 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-14 22:56:31,487 - main_orchestrator - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-14 22:56:38,259 - main_orchestrator - INFO - Starting integrated security analysis for alert 15
2025-08-14 22:56:38,259 - main_orchestrator - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-14 22:56:42,226 - main_orchestrator - INFO - ES Query Builder initialized successfully
2025-08-14 22:56:42,226 - main_orchestrator - INFO - Processing files using ES Query Builder
2025-08-14 22:56:42,227 - main_orchestrator - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-14 22:56:42,227 - main_orchestrator - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-14 22:56:43,080 - main_orchestrator - INFO - Loaded 58770 data entries from data.json
2025-08-14 22:56:43,080 - main_orchestrator - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-14 22:56:43,081 - main_orchestrator - INFO - Found matching data entry
2025-08-14 22:56:43,081 - main_orchestrator - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 22:56:43,081 - main_orchestrator - INFO - Generating Elasticsearch queries
2025-08-14 22:56:43,421 - main_orchestrator - INFO - 🔍 IP Behavior query detected for IPs: ['192.168.1.104']
2025-08-14 22:56:43,433 - main_orchestrator - INFO - Found 10 relevant events for IP behavior (threshold: 0.2)
2025-08-14 22:56:43,433 - main_orchestrator - INFO - Generated queries successfully
2025-08-14 22:56:43,433 - main_orchestrator - INFO - Generated Elasticsearch queries
2025-08-14 22:56:43,434 - main_orchestrator - INFO - 🎯 IP Behavior routing active: focusing on IPs 192.168.1.104
2025-08-14 22:56:43,434 - main_orchestrator - INFO - Orchestration planned: 4 agents
2025-08-14 22:56:43,435 - main_orchestrator - INFO - Executing agent: alert_history with ES context
2025-08-14 22:56:43,435 - main_orchestrator - INFO - Executing agent: ip_agent with ES context
2025-08-14 22:57:48,526 - main_orchestrator - INFO - Agent alert_history completed successfully with ES context
2025-08-14 22:57:48,527 - main_orchestrator - INFO - Parallel agent alert_history completed
2025-08-14 22:57:48,552 - main_orchestrator - INFO - Agent ip_agent completed successfully with ES context
2025-08-14 22:57:48,552 - main_orchestrator - INFO - Parallel agent ip_agent completed
2025-08-14 22:57:48,553 - main_orchestrator - INFO - Executing agent: summary with ES context
2025-08-14 22:57:48,554 - main_orchestrator - INFO - Agent summary completed successfully with ES context
2025-08-14 22:57:48,554 - main_orchestrator - INFO - Executing agent: timeline with ES context
2025-08-14 22:58:37,455 - main_orchestrator - INFO - Agent timeline completed successfully with ES context
2025-08-14 22:58:37,456 - main_orchestrator - INFO - Integrated security analysis completed successfully
2025-08-14 22:59:28,208 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-14 22:59:28,209 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-14 22:59:28,209 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-14 22:59:34,870 - __main__ - INFO - Starting integrated security analysis for alert 1
2025-08-14 22:59:34,870 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-14 22:59:38,625 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-14 22:59:38,625 - __main__ - INFO - Processing files using ES Query Builder
2025-08-14 22:59:38,625 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-14 22:59:38,626 - __main__ - INFO - Selected alert: Explicit Credential Logon Attempt
2025-08-14 22:59:39,402 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-14 22:59:39,402 - __main__ - INFO - Alert info extracted: event_ids=['b3866106-621f-4ad7-90bd-b2e2a5f0e694']
2025-08-14 22:59:39,403 - __main__ - INFO - Found matching data entry
2025-08-14 22:59:39,403 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-14 22:59:39,403 - __main__ - INFO - Generating Elasticsearch queries
2025-08-14 22:59:39,745 - __main__ - INFO - 🔍 IP Behavior query detected for IPs: ['10.0.0.1']
2025-08-14 22:59:39,756 - __main__ - INFO - Found 10 relevant events for IP behavior (threshold: 0.2)
2025-08-14 22:59:39,756 - __main__ - INFO - Generated queries successfully
2025-08-14 22:59:39,756 - __main__ - INFO - Generated Elasticsearch queries
2025-08-14 22:59:39,757 - __main__ - INFO - 🎯 IP Behavior routing active: focusing on IPs 10.0.0.1
2025-08-14 22:59:39,757 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-14 22:59:39,758 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-14 22:59:39,759 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-14 23:00:44,797 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-14 23:00:44,798 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 23:00:44,873 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-14 23:00:44,873 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 23:00:44,874 - __main__ - INFO - Executing agent: summary with ES context
2025-08-14 23:00:44,875 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-14 23:00:44,875 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-14 23:01:33,697 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-14 23:01:33,697 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-14 23:05:02,552 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-14 23:05:02,552 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-14 23:05:02,552 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-14 23:05:09,416 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-14 23:05:09,416 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-14 23:05:13,679 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-14 23:05:13,680 - __main__ - INFO - Processing files using ES Query Builder
2025-08-14 23:05:13,680 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-14 23:05:13,680 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-14 23:05:14,573 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-14 23:05:14,574 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-14 23:05:14,574 - __main__ - INFO - Found matching data entry
2025-08-14 23:05:14,574 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 23:05:14,574 - __main__ - INFO - Generating Elasticsearch queries
2025-08-14 23:05:14,921 - __main__ - INFO - 🔍 IP Behavior query detected for IPs: ['192.168.1.104']
2025-08-14 23:05:14,933 - __main__ - INFO - Found 10 relevant events for IP behavior (threshold: 0.2)
2025-08-14 23:05:14,933 - __main__ - INFO - Generated queries successfully
2025-08-14 23:05:14,934 - __main__ - INFO - Generated Elasticsearch queries
2025-08-14 23:05:14,934 - __main__ - INFO - 🎯 IP Behavior routing active: focusing on IPs 192.168.1.104
2025-08-14 23:05:14,935 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-14 23:05:14,935 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-14 23:05:14,936 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-14 23:06:20,069 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-14 23:06:20,069 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-14 23:06:20,070 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 23:06:20,070 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 23:06:20,071 - __main__ - INFO - Executing agent: summary with ES context
2025-08-14 23:06:20,072 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-14 23:06:20,072 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-14 23:07:08,951 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-14 23:07:08,952 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-14 23:15:52,146 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-14 23:15:52,146 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-14 23:15:52,146 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-14 23:15:59,019 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-14 23:15:59,019 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-14 23:16:03,633 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-14 23:16:03,633 - __main__ - INFO - Processing files using ES Query Builder
2025-08-14 23:16:03,634 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-14 23:16:03,634 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-14 23:16:04,539 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-14 23:16:04,540 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-14 23:16:04,540 - __main__ - INFO - Found matching data entry
2025-08-14 23:16:04,540 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 23:16:04,540 - __main__ - INFO - Generating Elasticsearch queries
2025-08-14 23:16:04,915 - __main__ - INFO - 🔍 IP Behavior query detected for IPs: ['192.168.1.104']
2025-08-14 23:16:04,926 - __main__ - INFO - Found 10 relevant events for IP behavior (threshold: 0.2)
2025-08-14 23:16:04,926 - __main__ - INFO - Generated queries successfully
2025-08-14 23:16:04,926 - __main__ - INFO - Generated Elasticsearch queries
2025-08-14 23:16:04,927 - __main__ - INFO - 🎯 IP Behavior routing active: focusing on IPs 192.168.1.104
2025-08-14 23:16:04,927 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-14 23:16:04,928 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-14 23:16:04,929 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-14 23:17:10,002 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-14 23:17:10,002 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 23:17:10,149 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-14 23:17:10,149 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 23:17:10,151 - __main__ - INFO - Executing agent: summary with ES context
2025-08-14 23:17:10,151 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-14 23:17:10,151 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-14 23:17:59,107 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-14 23:17:59,108 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-14 23:30:16,481 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-14 23:30:16,482 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-14 23:30:16,482 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-14 23:30:27,367 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-14 23:30:27,368 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-14 23:30:32,042 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-14 23:30:32,043 - __main__ - INFO - Processing files using ES Query Builder
2025-08-14 23:30:32,043 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-14 23:30:32,044 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-14 23:30:32,906 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-14 23:30:32,906 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-14 23:30:32,906 - __main__ - INFO - Found matching data entry
2025-08-14 23:30:32,907 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 23:30:32,907 - __main__ - INFO - Generating Elasticsearch queries
2025-08-14 23:30:33,270 - __main__ - INFO - 🔍 IP Behavior query detected for IPs: ['192.168.1.104']
2025-08-14 23:30:33,282 - __main__ - INFO - Found 10 relevant events for IP behavior (threshold: 0.2)
2025-08-14 23:30:33,282 - __main__ - INFO - Generated queries successfully
2025-08-14 23:30:33,282 - __main__ - INFO - Generated Elasticsearch queries
2025-08-14 23:30:33,283 - __main__ - INFO - 🎯 IP Behavior routing active: focusing on IPs 192.168.1.104
2025-08-14 23:30:33,283 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-14 23:30:33,284 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-14 23:30:33,284 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-14 23:31:38,389 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-14 23:31:38,389 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 23:31:38,404 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-14 23:31:38,405 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 23:31:38,406 - __main__ - INFO - Executing agent: summary with ES context
2025-08-14 23:31:38,406 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-14 23:31:38,406 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-14 23:32:27,233 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-14 23:32:27,234 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-14 23:42:21,261 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-14 23:42:21,262 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-14 23:42:21,262 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-14 23:42:28,754 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-14 23:42:28,755 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-14 23:42:32,548 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-14 23:42:32,549 - __main__ - INFO - Processing files using ES Query Builder
2025-08-14 23:42:32,549 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-14 23:42:32,549 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-14 23:42:33,371 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-14 23:42:33,372 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-14 23:42:33,372 - __main__ - INFO - Found matching data entry
2025-08-14 23:42:33,372 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 23:42:33,373 - __main__ - INFO - Generating Elasticsearch queries
2025-08-14 23:42:33,447 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-14 23:42:33,447 - __main__ - INFO - Generated queries successfully
2025-08-14 23:42:33,447 - __main__ - INFO - Generated Elasticsearch queries
2025-08-14 23:42:33,448 - __main__ - INFO - Orchestration planned: 5 agents
2025-08-14 23:42:33,449 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-14 23:42:33,449 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-14 23:42:33,450 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-14 23:43:22,522 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-14 23:43:22,522 - __main__ - INFO - Parallel agent user_context completed
2025-08-14 23:43:38,647 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-14 23:43:38,647 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 23:43:38,809 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-14 23:43:38,809 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 23:43:38,811 - __main__ - INFO - Executing agent: summary with ES context
2025-08-14 23:43:38,811 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-14 23:43:38,811 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-14 23:44:27,776 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-14 23:44:27,776 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-14 23:48:34,274 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-14 23:48:34,274 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-14 23:48:34,274 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-14 23:48:40,933 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-14 23:48:40,933 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-14 23:48:45,272 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-14 23:48:45,273 - __main__ - INFO - Processing files using ES Query Builder
2025-08-14 23:48:45,273 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-14 23:48:45,273 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-14 23:48:46,136 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-14 23:48:46,136 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-14 23:48:46,136 - __main__ - INFO - Found matching data entry
2025-08-14 23:48:46,137 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 23:48:46,137 - __main__ - INFO - Generating Elasticsearch queries
2025-08-14 23:48:46,493 - __main__ - INFO - 🔍 IP Behavior query detected for IPs: ['192.168.1.104']
2025-08-14 23:48:46,510 - __main__ - INFO - Found 10 relevant events for IP behavior (threshold: 0.2)
2025-08-14 23:48:46,510 - __main__ - INFO - Generated queries successfully
2025-08-14 23:48:46,510 - __main__ - INFO - Generated Elasticsearch queries
2025-08-14 23:48:46,511 - __main__ - INFO - 🎯 IP Behavior routing active: focusing on IPs 192.168.1.104
2025-08-14 23:48:46,512 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-14 23:48:46,513 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-14 23:48:46,513 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-14 23:49:51,646 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-14 23:49:51,647 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 23:49:51,792 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-14 23:49:51,792 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 23:49:51,793 - __main__ - INFO - Executing agent: summary with ES context
2025-08-14 23:49:51,794 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-14 23:49:51,794 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-14 23:50:40,561 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-14 23:50:40,562 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-14 23:54:05,463 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-14 23:54:05,463 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-14 23:54:05,464 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-14 23:54:14,242 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-14 23:54:14,242 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-14 23:54:18,552 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-14 23:54:18,553 - __main__ - INFO - Processing files using ES Query Builder
2025-08-14 23:54:18,553 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-14 23:54:18,553 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-14 23:54:19,383 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-14 23:54:19,384 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-14 23:54:19,384 - __main__ - INFO - Found matching data entry
2025-08-14 23:54:19,384 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-14 23:54:19,384 - __main__ - INFO - Generating Elasticsearch queries
2025-08-14 23:54:19,762 - __main__ - INFO - 🔍 IP Behavior query detected for IPs: ['192.168.1.104']
2025-08-14 23:54:19,775 - __main__ - INFO - Found 10 relevant events for IP behavior (threshold: 0.2)
2025-08-14 23:54:19,776 - __main__ - INFO - Generated queries successfully
2025-08-14 23:54:19,776 - __main__ - INFO - Generated Elasticsearch queries
2025-08-14 23:54:19,777 - __main__ - INFO - 🎯 IP Behavior routing active: focusing on IPs 192.168.1.104
2025-08-14 23:54:19,777 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-14 23:54:19,778 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-14 23:54:19,778 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-14 23:55:24,998 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-14 23:55:24,998 - __main__ - INFO - Parallel agent alert_history completed
2025-08-14 23:55:25,021 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-14 23:55:25,022 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-14 23:55:25,023 - __main__ - INFO - Executing agent: summary with ES context
2025-08-14 23:55:25,024 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-14 23:55:25,024 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-14 23:56:13,938 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-14 23:56:13,938 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-14 23:59:58,407 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-14 23:59:58,407 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-14 23:59:58,408 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-15 00:00:05,431 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-15 00:00:05,431 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-15 00:00:09,661 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-15 00:00:09,661 - __main__ - INFO - Processing files using ES Query Builder
2025-08-15 00:00:09,662 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-15 00:00:09,662 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-15 00:00:10,537 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-15 00:00:10,537 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-15 00:00:10,538 - __main__ - INFO - Found matching data entry
2025-08-15 00:00:10,538 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-15 00:00:10,538 - __main__ - INFO - Generating Elasticsearch queries
2025-08-15 00:00:10,624 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-15 00:00:10,625 - __main__ - INFO - Generated queries successfully
2025-08-15 00:00:10,625 - __main__ - INFO - Generated Elasticsearch queries
2025-08-15 00:00:10,626 - __main__ - INFO - Orchestration planned: 5 agents
2025-08-15 00:00:10,627 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-15 00:00:10,627 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-15 00:00:10,628 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-15 00:00:59,389 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-15 00:00:59,389 - __main__ - INFO - Parallel agent user_context completed
2025-08-15 00:01:15,424 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-15 00:01:15,424 - __main__ - INFO - Parallel agent alert_history completed
2025-08-15 00:01:15,500 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-15 00:01:15,500 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-15 00:01:15,502 - __main__ - INFO - Executing agent: summary with ES context
2025-08-15 00:01:15,502 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-15 00:01:15,502 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-15 00:02:04,208 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-15 00:02:04,209 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-15 00:34:49,211 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-15 00:34:49,211 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-15 00:34:49,211 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-15 00:34:56,230 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-15 00:34:56,230 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-15 00:35:00,772 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-15 00:35:00,772 - __main__ - INFO - Processing files using ES Query Builder
2025-08-15 00:35:00,773 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-15 00:35:00,773 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-15 00:35:01,929 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-15 00:35:01,930 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-15 00:35:01,930 - __main__ - INFO - Found matching data entry
2025-08-15 00:35:01,930 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-15 00:35:01,930 - __main__ - INFO - Generating Elasticsearch queries
2025-08-15 00:35:02,009 - __main__ - INFO - Found 9 relevant events (threshold: 0.3)
2025-08-15 00:35:02,010 - __main__ - INFO - Generated queries successfully
2025-08-15 00:35:02,010 - __main__ - INFO - Generated Elasticsearch queries
2025-08-15 00:35:02,011 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-15 00:35:02,012 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-15 00:35:02,013 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-15 00:35:50,711 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-15 00:35:50,712 - __main__ - INFO - Parallel agent user_context completed
2025-08-15 00:36:06,885 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-15 00:36:06,885 - __main__ - INFO - Parallel agent alert_history completed
2025-08-15 00:36:06,887 - __main__ - INFO - Executing agent: summary with ES context
2025-08-15 00:36:06,887 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-15 00:36:06,887 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-15 00:36:55,531 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-15 00:36:55,531 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-15 00:42:24,922 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-15 00:42:24,922 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-15 00:42:24,922 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-15 00:42:31,459 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-15 00:42:31,459 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-15 00:42:35,670 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-15 00:42:35,670 - __main__ - INFO - Processing files using ES Query Builder
2025-08-15 00:42:35,671 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-15 00:42:35,671 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-15 00:42:36,548 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-15 00:42:36,549 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-15 00:42:36,549 - __main__ - INFO - Found matching data entry
2025-08-15 00:42:36,549 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-15 00:42:36,549 - __main__ - INFO - Generating Elasticsearch queries
2025-08-15 00:42:36,608 - __main__ - INFO - Found 9 relevant events (threshold: 0.3)
2025-08-15 00:42:36,608 - __main__ - INFO - Generated queries successfully
2025-08-15 00:42:36,608 - __main__ - INFO - Generated Elasticsearch queries
2025-08-15 00:42:36,609 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-15 00:42:36,610 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-15 00:42:36,610 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-15 00:43:25,481 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-15 00:43:25,482 - __main__ - INFO - Parallel agent user_context completed
2025-08-15 00:43:41,833 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-15 00:43:41,834 - __main__ - INFO - Parallel agent alert_history completed
2025-08-15 00:43:41,835 - __main__ - INFO - Executing agent: summary with ES context
2025-08-15 00:43:41,835 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-15 00:43:41,836 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-15 00:44:30,730 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-15 00:44:30,731 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-15 00:47:10,158 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-15 00:47:10,158 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-15 00:47:10,158 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-15 00:47:17,283 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-15 00:47:17,284 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-15 00:47:21,081 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-15 00:47:21,082 - __main__ - INFO - Processing files using ES Query Builder
2025-08-15 00:47:21,082 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-15 00:47:21,082 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-15 00:47:21,912 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-15 00:47:21,912 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-15 00:47:21,912 - __main__ - INFO - Found matching data entry
2025-08-15 00:47:21,912 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-15 00:47:21,912 - __main__ - INFO - Generating Elasticsearch queries
2025-08-15 00:47:21,921 - __main__ - INFO - Found 9 relevant events (threshold: 0.3)
2025-08-15 00:47:21,921 - __main__ - INFO - Generated queries successfully
2025-08-15 00:47:21,921 - __main__ - INFO - Generated Elasticsearch queries
2025-08-15 00:47:21,922 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-15 00:47:21,922 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-15 00:47:21,923 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-15 00:48:10,758 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-15 00:48:10,759 - __main__ - INFO - Parallel agent user_context completed
2025-08-15 00:48:27,065 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-15 00:48:27,066 - __main__ - INFO - Parallel agent alert_history completed
2025-08-15 00:48:27,067 - __main__ - INFO - Executing agent: summary with ES context
2025-08-15 00:48:27,068 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-15 00:48:27,068 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-15 00:49:16,129 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-15 00:49:16,130 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-15 10:06:51,104 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-15 10:06:51,106 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-15 10:06:51,106 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-15 10:07:03,447 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-15 10:07:03,447 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-15 10:07:08,200 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-15 10:07:08,200 - __main__ - INFO - Processing files using ES Query Builder
2025-08-15 10:07:08,212 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-15 10:07:08,213 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-15 10:07:09,276 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-15 10:07:09,277 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-15 10:07:09,277 - __main__ - INFO - Found matching data entry
2025-08-15 10:07:09,277 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-15 10:07:09,277 - __main__ - INFO - Generating Elasticsearch queries
2025-08-15 10:07:09,677 - __main__ - INFO - 🔍 IP Behavior query detected for IPs: ['192.168.1.104']
2025-08-15 10:07:09,692 - __main__ - INFO - Found 9 relevant events for IP behavior (threshold: 0.2)
2025-08-15 10:07:09,692 - __main__ - INFO - Generated queries successfully
2025-08-15 10:07:09,693 - __main__ - INFO - Generated Elasticsearch queries
2025-08-15 10:07:09,694 - __main__ - INFO - 🎯 IP Behavior routing active: focusing on IPs 192.168.1.104
2025-08-15 10:07:09,694 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-15 10:07:09,696 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-15 10:07:09,696 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-15 10:08:14,877 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-15 10:08:14,878 - __main__ - INFO - Parallel agent alert_history completed
2025-08-15 10:08:14,964 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-15 10:08:14,965 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-15 10:08:14,967 - __main__ - INFO - Executing agent: summary with ES context
2025-08-15 10:08:14,968 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-15 10:08:14,968 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-15 10:09:03,975 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-15 10:09:03,976 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-15 10:27:51,948 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-15 10:27:51,949 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-15 10:27:51,949 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-15 10:28:02,055 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-15 10:28:02,056 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-15 10:28:07,175 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-15 10:28:07,175 - __main__ - INFO - Processing files using ES Query Builder
2025-08-15 10:28:07,176 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-15 10:28:07,177 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-15 10:28:08,105 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-15 10:28:08,106 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-15 10:28:08,106 - __main__ - INFO - Found matching data entry
2025-08-15 10:28:08,106 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-15 10:28:08,106 - __main__ - INFO - Generating Elasticsearch queries
2025-08-15 10:28:08,117 - __main__ - INFO - Found 9 relevant events (threshold: 0.3)
2025-08-15 10:28:08,117 - __main__ - INFO - Generated queries successfully
2025-08-15 10:28:08,117 - __main__ - INFO - Generated Elasticsearch queries
2025-08-15 10:28:08,119 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-15 10:28:08,120 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-15 10:28:08,120 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-15 10:29:17,951 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-15 10:29:17,952 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-15 10:29:17,952 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-15 10:29:29,948 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-15 10:29:29,949 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-15 10:29:36,117 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-15 10:29:36,117 - __main__ - INFO - Processing files using ES Query Builder
2025-08-15 10:29:36,118 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-15 10:29:36,118 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-15 10:29:37,491 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-15 10:29:37,492 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-15 10:29:37,492 - __main__ - INFO - Found matching data entry
2025-08-15 10:29:37,492 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-15 10:29:37,493 - __main__ - INFO - Generating Elasticsearch queries
2025-08-15 10:29:37,500 - __main__ - ERROR - Error generating Elasticsearch queries: '>' not supported between instances of 'int' and 'NoneType'
2025-08-15 10:29:37,501 - __main__ - ERROR - Error in integrated security analysis: '>' not supported between instances of 'int' and 'NoneType'
2025-08-15 10:29:37,503 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\ADMIN\Desktop\latest\main_orchestrator.py", line 798, in analyze_security_alert_integrated
    es_query_result = self.generate_elasticsearch_queries(alert, data_entry, user_prompt)
  File "C:\Users\ADMIN\Desktop\latest\main_orchestrator.py", line 248, in generate_elasticsearch_queries
    query_result = self.es_query_builder.process_alert_query(alert, data_entry, user_prompt)
  File "C:\Users\ADMIN\Desktop\latest\elastic_search.py", line 1000, in process_alert_query
    return self._process_contextual_query(alert_data, data_entry, user_prompt)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ADMIN\Desktop\latest\elastic_search.py", line 1052, in _process_contextual_query
    contextual_query = self.build_contextual_query(alert_info, data_context, user_prompt)
  File "C:\Users\ADMIN\Desktop\latest\elastic_search.py", line 616, in build_contextual_query
    query_size = max(query_size, 1000)  # Ensure we get enough data for pattern analysis
TypeError: '>' not supported between instances of 'int' and 'NoneType'

2025-08-15 10:30:05,116 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-15 10:30:05,116 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-15 10:30:05,116 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-15 10:30:16,680 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-15 10:30:16,680 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-15 10:30:22,903 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-15 10:30:22,904 - __main__ - INFO - Processing files using ES Query Builder
2025-08-15 10:30:22,904 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-15 10:30:22,905 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-15 10:30:24,104 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-15 10:30:24,105 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-15 10:30:24,105 - __main__ - INFO - Found matching data entry
2025-08-15 10:30:24,105 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-15 10:30:24,106 - __main__ - INFO - Generating Elasticsearch queries
2025-08-15 10:30:24,122 - __main__ - INFO - Found 9 relevant events (threshold: 0.3)
2025-08-15 10:30:24,123 - __main__ - INFO - Generated queries successfully
2025-08-15 10:30:24,123 - __main__ - INFO - Generated Elasticsearch queries
2025-08-15 10:30:24,124 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-15 10:30:24,125 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-15 10:30:24,126 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-15 10:31:12,990 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-15 10:31:12,991 - __main__ - INFO - Parallel agent user_context completed
2025-08-15 10:31:29,293 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-15 10:31:29,293 - __main__ - INFO - Parallel agent alert_history completed
2025-08-15 10:31:29,296 - __main__ - INFO - Executing agent: summary with ES context
2025-08-15 10:31:29,297 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-15 10:31:29,297 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-15 10:32:18,171 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-15 10:32:18,172 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-15 10:36:06,514 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-15 10:36:06,516 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-15 10:36:06,516 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-15 10:36:19,608 - __main__ - INFO - Starting integrated security analysis for alert 1
2025-08-15 10:36:19,609 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-15 10:36:25,258 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-15 10:36:25,259 - __main__ - INFO - Processing files using ES Query Builder
2025-08-15 10:36:25,260 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-15 10:36:25,260 - __main__ - INFO - Selected alert: Explicit Credential Logon Attempt
2025-08-15 10:36:26,409 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-15 10:36:26,409 - __main__ - INFO - Alert info extracted: event_ids=['b3866106-621f-4ad7-90bd-b2e2a5f0e694']
2025-08-15 10:36:26,410 - __main__ - INFO - Found matching data entry
2025-08-15 10:36:26,410 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-15 10:36:26,411 - __main__ - INFO - Generating Elasticsearch queries
2025-08-15 10:36:27,114 - __main__ - INFO - 🔍 IP Behavior query detected for IPs: ['10.0.0.1']
2025-08-15 10:36:27,126 - __main__ - INFO - Found 9 relevant events for IP behavior (threshold: 0.2)
2025-08-15 10:36:27,126 - __main__ - INFO - Generated queries successfully
2025-08-15 10:36:27,127 - __main__ - INFO - Generated Elasticsearch queries
2025-08-15 10:36:27,128 - __main__ - INFO - 🎯 IP Behavior routing active: focusing on IPs 10.0.0.1
2025-08-15 10:36:27,128 - __main__ - INFO - Orchestration planned: 5 agents
2025-08-15 10:36:27,130 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-15 10:36:27,131 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-15 10:36:27,131 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-15 10:37:16,091 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-15 10:37:16,092 - __main__ - INFO - Parallel agent user_context completed
2025-08-15 10:37:32,323 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-15 10:37:32,324 - __main__ - INFO - Parallel agent alert_history completed
2025-08-15 10:37:32,570 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-15 10:37:32,570 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-15 10:37:32,579 - __main__ - INFO - Executing agent: summary with ES context
2025-08-15 10:37:32,580 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-15 10:37:32,580 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-15 10:38:21,528 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-15 10:38:21,529 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-15 10:42:56,412 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-15 10:42:56,413 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-15 10:42:56,413 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-15 10:43:06,581 - __main__ - INFO - Starting integrated security analysis for alert 1
2025-08-15 10:43:06,582 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-15 10:43:12,586 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-15 10:43:12,586 - __main__ - INFO - Processing files using ES Query Builder
2025-08-15 10:43:12,588 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-15 10:43:12,588 - __main__ - INFO - Selected alert: Explicit Credential Logon Attempt
2025-08-15 10:43:13,875 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-15 10:43:13,876 - __main__ - INFO - Alert info extracted: event_ids=['b3866106-621f-4ad7-90bd-b2e2a5f0e694']
2025-08-15 10:43:13,876 - __main__ - INFO - Found matching data entry
2025-08-15 10:43:13,876 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-15 10:43:13,877 - __main__ - INFO - Generating Elasticsearch queries
2025-08-15 10:43:14,515 - __main__ - INFO - 🔍 IP Behavior query detected for IPs: ['10.0.0.1']
2025-08-15 10:43:14,523 - __main__ - INFO - Found 10 relevant events for IP behavior (threshold: 0.2)
2025-08-15 10:43:14,524 - __main__ - INFO - Generated queries successfully
2025-08-15 10:43:14,524 - __main__ - INFO - Generated Elasticsearch queries
2025-08-15 10:43:14,525 - __main__ - INFO - 🎯 IP Behavior routing active: focusing on IPs 10.0.0.1
2025-08-15 10:43:14,526 - __main__ - INFO - Orchestration planned: 5 agents
2025-08-15 10:43:14,527 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-15 10:43:14,528 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-15 10:43:14,529 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-15 10:44:03,552 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-15 10:44:03,554 - __main__ - INFO - Parallel agent user_context completed
2025-08-15 10:44:19,792 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-15 10:44:19,793 - __main__ - INFO - Parallel agent alert_history completed
2025-08-15 10:44:19,844 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-15 10:44:19,845 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-15 10:44:19,849 - __main__ - INFO - Executing agent: summary with ES context
2025-08-15 10:44:19,850 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-15 10:44:19,850 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-15 10:45:08,881 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-15 10:45:08,882 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-15 10:46:24,537 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-15 10:46:24,537 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-15 10:46:24,538 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-15 10:46:36,202 - __main__ - INFO - Starting integrated security analysis for alert 1
2025-08-15 10:46:36,203 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-15 10:46:42,364 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-15 10:46:42,364 - __main__ - INFO - Processing files using ES Query Builder
2025-08-15 10:46:42,365 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-15 10:46:42,366 - __main__ - INFO - Selected alert: Explicit Credential Logon Attempt
2025-08-15 10:46:43,566 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-15 10:46:43,567 - __main__ - INFO - Alert info extracted: event_ids=['b3866106-621f-4ad7-90bd-b2e2a5f0e694']
2025-08-15 10:46:43,568 - __main__ - INFO - Found matching data entry
2025-08-15 10:46:43,568 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-15 10:46:43,568 - __main__ - INFO - Generating Elasticsearch queries
2025-08-15 10:46:43,583 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-15 10:46:43,584 - __main__ - INFO - Generated queries successfully
2025-08-15 10:46:43,584 - __main__ - INFO - Generated Elasticsearch queries
2025-08-15 10:46:43,585 - __main__ - INFO - Orchestration planned: 5 agents
2025-08-15 10:46:43,587 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-15 10:46:43,588 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-15 10:46:43,589 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-15 10:47:32,595 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-15 10:47:32,596 - __main__ - INFO - Parallel agent user_context completed
2025-08-15 10:47:48,775 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-15 10:47:48,776 - __main__ - INFO - Parallel agent alert_history completed
2025-08-15 10:47:49,003 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-15 10:47:49,004 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-15 10:47:49,007 - __main__ - INFO - Executing agent: summary with ES context
2025-08-15 10:47:49,007 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-15 10:47:49,008 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-15 10:48:37,930 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-15 10:48:37,931 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-15 10:51:32,072 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-15 10:51:32,072 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-15 10:51:32,072 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-15 10:51:42,297 - __main__ - INFO - Starting integrated security analysis for alert 1
2025-08-15 10:51:42,297 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-15 10:51:48,253 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-15 10:51:48,254 - __main__ - INFO - Processing files using ES Query Builder
2025-08-15 10:51:48,255 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-15 10:51:48,255 - __main__ - INFO - Selected alert: Explicit Credential Logon Attempt
2025-08-15 10:51:49,485 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-15 10:51:49,485 - __main__ - INFO - Alert info extracted: event_ids=['b3866106-621f-4ad7-90bd-b2e2a5f0e694']
2025-08-15 10:51:49,485 - __main__ - INFO - Found matching data entry
2025-08-15 10:51:49,486 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-15 10:51:49,486 - __main__ - INFO - Generating Elasticsearch queries
2025-08-15 10:51:49,500 - __main__ - INFO - Found 9 relevant events (threshold: 0.3)
2025-08-15 10:51:49,500 - __main__ - INFO - Generated queries successfully
2025-08-15 10:51:49,500 - __main__ - INFO - Generated Elasticsearch queries
2025-08-15 10:51:49,502 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-15 10:51:49,503 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-15 10:51:49,504 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-15 10:52:38,480 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-15 10:52:38,480 - __main__ - INFO - Parallel agent user_context completed
2025-08-15 10:52:54,734 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-15 10:52:54,735 - __main__ - INFO - Parallel agent alert_history completed
2025-08-15 10:52:54,737 - __main__ - INFO - Executing agent: summary with ES context
2025-08-15 10:52:54,738 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-15 10:52:54,738 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-15 10:53:43,696 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-15 10:53:43,697 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-15 10:56:10,231 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-15 10:56:10,232 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-15 10:56:10,232 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-15 10:56:20,849 - __main__ - INFO - Starting integrated security analysis for alert 1
2025-08-15 10:56:20,849 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-15 10:56:26,469 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-15 10:56:26,470 - __main__ - INFO - Processing files using ES Query Builder
2025-08-15 10:56:26,471 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-15 10:56:26,471 - __main__ - INFO - Selected alert: Explicit Credential Logon Attempt
2025-08-15 10:56:27,585 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-15 10:56:27,596 - __main__ - INFO - Alert info extracted: event_ids=['b3866106-621f-4ad7-90bd-b2e2a5f0e694']
2025-08-15 10:56:27,606 - __main__ - INFO - Found matching data entry
2025-08-15 10:56:27,618 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-15 10:56:27,621 - __main__ - INFO - Generating Elasticsearch queries
2025-08-15 10:56:27,653 - __main__ - INFO - Found 6 relevant events (threshold: 0.3)
2025-08-15 10:56:27,654 - __main__ - INFO - Generated queries successfully
2025-08-15 10:56:27,654 - __main__ - INFO - Generated Elasticsearch queries
2025-08-15 10:56:27,655 - __main__ - INFO - Orchestration planned: 3 agents
2025-08-15 10:56:27,657 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-15 10:57:33,082 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-15 10:57:33,083 - __main__ - INFO - Parallel agent alert_history completed
2025-08-15 10:57:33,085 - __main__ - INFO - Executing agent: summary with ES context
2025-08-15 10:57:33,085 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-15 10:57:33,085 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-15 10:58:22,153 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-15 10:58:22,154 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-15 11:21:29,548 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-15 11:21:29,548 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-15 11:21:29,549 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-15 11:21:56,260 - __main__ - INFO - Starting integrated security analysis for alert 1
2025-08-15 11:21:56,260 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-15 11:22:01,929 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-15 11:22:01,930 - __main__ - INFO - Processing files using ES Query Builder
2025-08-15 11:22:01,931 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-15 11:22:01,931 - __main__ - INFO - Selected alert: Explicit Credential Logon Attempt
2025-08-15 11:22:03,122 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-15 11:22:03,122 - __main__ - INFO - Alert info extracted: event_ids=['b3866106-621f-4ad7-90bd-b2e2a5f0e694']
2025-08-15 11:22:03,123 - __main__ - INFO - Found matching data entry
2025-08-15 11:22:03,123 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-15 11:22:03,123 - __main__ - INFO - Generating Elasticsearch queries
2025-08-15 11:22:03,137 - __main__ - INFO - Found 9 relevant events (threshold: 0.3)
2025-08-15 11:22:03,137 - __main__ - INFO - Generated queries successfully
2025-08-15 11:22:03,137 - __main__ - INFO - Generated Elasticsearch queries
2025-08-15 11:22:03,139 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-15 11:22:03,142 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-15 11:22:03,142 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-15 11:22:52,219 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-15 11:22:52,219 - __main__ - INFO - Parallel agent user_context completed
2025-08-15 11:23:08,245 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-15 11:23:08,246 - __main__ - INFO - Parallel agent alert_history completed
2025-08-15 11:23:08,248 - __main__ - INFO - Executing agent: summary with ES context
2025-08-15 11:23:08,249 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-15 11:23:08,249 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-15 11:23:57,313 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-15 11:23:57,314 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-15 14:42:04,489 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-15 14:42:04,490 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-15 14:42:04,490 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-15 14:42:18,061 - __main__ - INFO - Starting integrated security analysis for alert 1
2025-08-15 14:42:18,061 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-15 14:42:22,825 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-15 14:42:22,825 - __main__ - INFO - Processing files using ES Query Builder
2025-08-15 14:42:22,841 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-15 14:42:22,842 - __main__ - INFO - Selected alert: Explicit Credential Logon Attempt
2025-08-15 14:42:23,909 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-15 14:42:23,909 - __main__ - INFO - Alert info extracted: event_ids=['b3866106-621f-4ad7-90bd-b2e2a5f0e694']
2025-08-15 14:42:23,909 - __main__ - INFO - Found matching data entry
2025-08-15 14:42:23,909 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-15 14:42:23,910 - __main__ - INFO - Generating Elasticsearch queries
2025-08-15 14:42:23,923 - __main__ - INFO - Found 9 relevant events (threshold: 0.3)
2025-08-15 14:42:23,923 - __main__ - INFO - Generated queries successfully
2025-08-15 14:42:23,923 - __main__ - INFO - Generated Elasticsearch queries
2025-08-15 14:42:23,924 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-15 14:42:23,925 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-15 14:42:23,926 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-15 14:43:13,104 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-15 14:43:13,112 - __main__ - INFO - Parallel agent user_context completed
2025-08-15 14:43:29,440 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-15 14:43:29,441 - __main__ - INFO - Parallel agent alert_history completed
2025-08-15 14:43:29,448 - __main__ - INFO - Executing agent: summary with ES context
2025-08-15 14:43:29,448 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-15 14:43:29,448 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-15 14:44:18,611 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-15 14:44:18,612 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-16 20:33:26,470 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-16 20:33:26,478 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-16 20:33:26,478 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-16 20:33:32,419 - __main__ - INFO - Starting integrated security analysis for alert 16
2025-08-16 20:33:32,420 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-16 20:33:37,435 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-16 20:33:37,436 - __main__ - INFO - Processing files using ES Query Builder
2025-08-16 20:33:37,437 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-16 20:33:37,437 - __main__ - INFO - Selected alert: Execution of Suspicious Script
2025-08-16 20:33:38,468 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-16 20:33:38,469 - __main__ - INFO - Alert info extracted: event_ids=['352b7f93-9170-4dcb-9a10-cbbff6378ff6']
2025-08-16 20:33:38,469 - __main__ - INFO - Found matching data entry
2025-08-16 20:33:38,470 - __main__ - INFO - Loaded alert: Execution of Suspicious Script
2025-08-16 20:33:38,470 - __main__ - INFO - Generating Elasticsearch queries
2025-08-16 20:33:38,496 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-16 20:33:38,496 - __main__ - INFO - Generated queries successfully
2025-08-16 20:33:38,497 - __main__ - INFO - Generated Elasticsearch queries
2025-08-16 20:33:38,498 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-16 20:33:38,498 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-16 20:33:38,499 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-16 20:34:27,519 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-16 20:34:27,529 - __main__ - INFO - Parallel agent user_context completed
2025-08-16 20:34:43,807 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-16 20:34:43,807 - __main__ - INFO - Parallel agent alert_history completed
2025-08-16 20:34:43,809 - __main__ - INFO - Executing agent: summary with ES context
2025-08-16 20:34:43,809 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-16 20:34:43,810 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-16 20:35:32,849 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-16 20:35:32,849 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-16 21:54:11,411 - gpu_utils - INFO - 💻 CUDA not available (torch.cuda.is_available() = False), using CPU
2025-08-16 21:54:11,411 - gpu_utils - INFO - 💻 Using CPU for computation
2025-08-16 21:54:11,412 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cpu', 'device_type': 'cpu', 'amp_enabled': False}
2025-08-16 21:54:16,722 - __main__ - INFO - Starting integrated security analysis for alert 16
2025-08-16 21:54:16,722 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-16 21:54:20,472 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-16 21:54:20,472 - __main__ - INFO - Processing files using ES Query Builder
2025-08-16 21:54:20,483 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-16 21:54:20,483 - __main__ - INFO - Selected alert: Execution of Suspicious Script
2025-08-16 21:54:21,286 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-16 21:54:21,287 - __main__ - INFO - Alert info extracted: event_ids=['352b7f93-9170-4dcb-9a10-cbbff6378ff6']
2025-08-16 21:54:21,287 - __main__ - INFO - Found matching data entry
2025-08-16 21:54:21,287 - __main__ - INFO - Loaded alert: Execution of Suspicious Script
2025-08-16 21:54:21,287 - __main__ - INFO - Generating Elasticsearch queries
2025-08-16 21:54:21,287 - __main__ - ERROR - Error generating Elasticsearch queries: 'ElasticsearchQueryBuilder' object has no attribute '_is_ip_behavior_intent'
2025-08-16 21:54:21,288 - __main__ - ERROR - Error in integrated security analysis: 'ElasticsearchQueryBuilder' object has no attribute '_is_ip_behavior_intent'
2025-08-16 21:54:21,289 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "d:\backup_02\latest\main_orchestrator.py", line 798, in analyze_security_alert_integrated
    es_query_result = self.generate_elasticsearch_queries(alert, data_entry, user_prompt)
  File "d:\backup_02\latest\main_orchestrator.py", line 248, in generate_elasticsearch_queries
    query_result = self.es_query_builder.process_alert_query(alert, data_entry, user_prompt)
  File "d:\backup_02\latest\elastic_search.py", line 930, in process_alert_query
    if self._is_ip_behavior_intent(user_prompt):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ElasticsearchQueryBuilder' object has no attribute '_is_ip_behavior_intent'

2025-08-16 22:02:10,275 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-16 22:02:10,275 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-16 22:02:10,275 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-16 22:02:10,283 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-16 22:02:17,011 - __main__ - INFO - Starting integrated security analysis for alert 16
2025-08-16 22:02:17,011 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-16 22:02:20,751 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-16 22:02:20,751 - __main__ - INFO - Processing files using ES Query Builder
2025-08-16 22:02:20,751 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-16 22:02:20,751 - __main__ - INFO - Selected alert: Execution of Suspicious Script
2025-08-16 22:02:21,641 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-16 22:02:21,641 - __main__ - INFO - Alert info extracted: event_ids=['352b7f93-9170-4dcb-9a10-cbbff6378ff6']
2025-08-16 22:02:21,643 - __main__ - INFO - Found matching data entry
2025-08-16 22:02:21,643 - __main__ - INFO - Loaded alert: Execution of Suspicious Script
2025-08-16 22:02:21,644 - __main__ - INFO - Generating Elasticsearch queries
2025-08-16 22:02:21,644 - __main__ - ERROR - Error generating Elasticsearch queries: 'ElasticsearchQueryBuilder' object has no attribute '_is_ip_behavior_intent'
2025-08-16 22:02:21,644 - __main__ - ERROR - Error in integrated security analysis: 'ElasticsearchQueryBuilder' object has no attribute '_is_ip_behavior_intent'
2025-08-16 22:02:21,647 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "D:\backup_02\latest\main_orchestrator.py", line 747, in analyze_security_alert_integrated
    es_query_result = self.generate_elasticsearch_queries(alert, data_entry, user_prompt)
  File "D:\backup_02\latest\main_orchestrator.py", line 247, in generate_elasticsearch_queries
    query_result = self.es_query_builder.process_alert_query(alert, data_entry, user_prompt)
  File "D:\backup_02\latest\elastic_search.py", line 930, in process_alert_query
    if self._is_ip_behavior_intent(user_prompt):
AttributeError: 'ElasticsearchQueryBuilder' object has no attribute '_is_ip_behavior_intent'

2025-08-16 22:07:31,273 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-16 22:07:31,273 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-16 22:07:31,273 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-16 22:07:31,273 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-16 22:07:37,719 - __main__ - INFO - Starting integrated security analysis for alert 16
2025-08-16 22:07:37,719 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-16 22:07:41,348 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-16 22:07:41,348 - __main__ - INFO - Processing files using ES Query Builder
2025-08-16 22:07:41,348 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-16 22:07:41,348 - __main__ - INFO - Selected alert: Execution of Suspicious Script
2025-08-16 22:07:42,253 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-16 22:07:42,253 - __main__ - INFO - Alert info extracted: event_ids=['352b7f93-9170-4dcb-9a10-cbbff6378ff6']
2025-08-16 22:07:42,253 - __main__ - INFO - Found matching data entry
2025-08-16 22:07:42,253 - __main__ - INFO - Loaded alert: Execution of Suspicious Script
2025-08-16 22:07:42,253 - __main__ - INFO - Generating Elasticsearch queries
2025-08-16 22:07:47,571 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-16 22:07:47,571 - __main__ - INFO - Generated queries successfully
2025-08-16 22:07:47,571 - __main__ - INFO - Generated Elasticsearch queries
2025-08-16 22:07:47,571 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-16 22:07:47,583 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-16 22:07:47,583 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-16 22:07:47,602 - __main__ - ERROR - Error executing agent user_context: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
2025-08-16 22:07:47,607 - __main__ - ERROR - Error executing agent alert_history: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
2025-08-16 22:07:47,651 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "D:\backup_02\latest\main_orchestrator.py", line 312, in execute_agent_with_es_context
    result = agent.analyze_user(alert, data_entry, prompt)
  File "D:\backup_02\latest\user_context.py", line 314, in analyze_user
    intent_categories = self.analyze_query_intent(analysis_prompt)
  File "D:\backup_02\latest\user_context.py", line 86, in analyze_query_intent
    prompt_embedding = self._get_embeddings([analysis_prompt])
  File "D:\backup_02\latest\user_context.py", line 40, in _get_embeddings
    outputs = self.model(**inputs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 942, in forward
    embedding_output = self.embeddings(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 180, in forward
    inputs_embeds = self.word_embeddings(input_ids)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
    return F.embedding(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\functional.py", line 2551, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)

2025-08-16 22:07:47,651 - __main__ - INFO - Parallel agent user_context completed
2025-08-16 22:07:47,653 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "D:\backup_02\latest\alert_history.py", line 43, in _get_embeddings
    outputs = self.model(**inputs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 942, in forward
    embedding_output = self.embeddings(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 180, in forward
    inputs_embeds = self.word_embeddings(input_ids)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
    return F.embedding(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\functional.py", line 2551, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\backup_02\latest\main_orchestrator.py", line 331, in execute_agent_with_es_context
    result = agent.analyze_alert_history(alert, data_entry, prompt)
  File "D:\backup_02\latest\alert_history.py", line 426, in analyze_alert_history
    history_intent = self.analyze_history_intent(analysis_prompt)
  File "D:\backup_02\latest\alert_history.py", line 104, in analyze_history_intent
    prompt_embedding = self._get_embeddings([analysis_prompt])
  File "D:\backup_02\latest\alert_history.py", line 58, in _get_embeddings
    outputs = self.model(**inputs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 942, in forward
    embedding_output = self.embeddings(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 180, in forward
    inputs_embeds = self.word_embeddings(input_ids)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
    return F.embedding(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\functional.py", line 2551, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)

2025-08-16 22:07:47,654 - __main__ - INFO - Parallel agent alert_history completed
2025-08-16 22:07:47,654 - __main__ - INFO - Executing agent: summary with ES context
2025-08-16 22:07:47,654 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-16 22:07:47,655 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-16 22:07:47,656 - __main__ - ERROR - Error executing agent timeline: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
2025-08-16 22:07:47,657 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "D:\backup_02\latest\main_orchestrator.py", line 325, in execute_agent_with_es_context
    result = agent.analyze_timeline(alert, data_entry, prompt, other_agent_data)
  File "D:\backup_02\latest\timeline_agent.py", line 464, in analyze_timeline
    timeline_intent = self.analyze_timeline_intent(analysis_prompt)
  File "D:\backup_02\latest\timeline_agent.py", line 81, in analyze_timeline_intent
    prompt_embedding = self._get_embeddings([analysis_prompt])
  File "D:\backup_02\latest\timeline_agent.py", line 29, in _get_embeddings
    outputs = self.model(**inputs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 942, in forward
    embedding_output = self.embeddings(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 180, in forward
    inputs_embeds = self.word_embeddings(input_ids)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
    return F.embedding(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\functional.py", line 2551, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)

2025-08-16 22:07:47,657 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-16 22:22:19,958 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-16 22:22:19,958 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-16 22:22:19,958 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-16 22:22:19,958 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-16 22:22:26,110 - __main__ - INFO - Starting integrated security analysis for alert 16
2025-08-16 22:22:26,110 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-16 22:22:29,903 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-16 22:22:29,903 - __main__ - INFO - Processing files using ES Query Builder
2025-08-16 22:22:29,906 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-16 22:22:29,906 - __main__ - INFO - Selected alert: Execution of Suspicious Script
2025-08-16 22:22:30,763 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-16 22:22:30,764 - __main__ - INFO - Alert info extracted: event_ids=['352b7f93-9170-4dcb-9a10-cbbff6378ff6']
2025-08-16 22:22:30,764 - __main__ - INFO - Found matching data entry
2025-08-16 22:22:30,764 - __main__ - INFO - Loaded alert: Execution of Suspicious Script
2025-08-16 22:22:30,764 - __main__ - INFO - Generating Elasticsearch queries
2025-08-16 22:22:36,103 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-16 22:22:36,103 - __main__ - INFO - Generated queries successfully
2025-08-16 22:22:36,105 - __main__ - INFO - Generated Elasticsearch queries
2025-08-16 22:22:36,105 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-16 22:22:36,106 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-16 22:22:36,107 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-16 22:22:36,108 - __main__ - ERROR - Error executing agent user_context: 'UserContextAgent' object has no attribute 'suppress_internal_errors'
2025-08-16 22:22:36,108 - __main__ - ERROR - Error executing agent alert_history: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
2025-08-16 22:22:36,116 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "D:\backup_02\latest\user_context.py", line 43, in _get_embeddings
    outputs = self.model(**inputs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 942, in forward
    embedding_output = self.embeddings(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 180, in forward
    inputs_embeds = self.word_embeddings(input_ids)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
    return F.embedding(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\functional.py", line 2551, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\backup_02\latest\user_context.py", line 96, in analyze_query_intent
    prompt_embedding = self._get_embeddings([analysis_prompt])
  File "D:\backup_02\latest\user_context.py", line 47, in _get_embeddings
    if self.suppress_internal_errors:
AttributeError: 'UserContextAgent' object has no attribute 'suppress_internal_errors'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\backup_02\latest\user_context.py", line 323, in analyze_user
    intent_categories = self.analyze_query_intent(analysis_prompt)
  File "D:\backup_02\latest\user_context.py", line 122, in analyze_query_intent
    if self.suppress_internal_errors:
AttributeError: 'UserContextAgent' object has no attribute 'suppress_internal_errors'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\backup_02\latest\main_orchestrator.py", line 312, in execute_agent_with_es_context
    result = agent.analyze_user(alert, data_entry, prompt)
  File "D:\backup_02\latest\user_context.py", line 342, in analyze_user
    if self.suppress_internal_errors:
AttributeError: 'UserContextAgent' object has no attribute 'suppress_internal_errors'

2025-08-16 22:22:36,117 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "D:\backup_02\latest\alert_history.py", line 43, in _get_embeddings
    outputs = self.model(**inputs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 942, in forward
    embedding_output = self.embeddings(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 180, in forward
    inputs_embeds = self.word_embeddings(input_ids)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
    return F.embedding(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\functional.py", line 2551, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\backup_02\latest\main_orchestrator.py", line 331, in execute_agent_with_es_context
    result = agent.analyze_alert_history(alert, data_entry, prompt)
  File "D:\backup_02\latest\alert_history.py", line 426, in analyze_alert_history
    history_intent = self.analyze_history_intent(analysis_prompt)
  File "D:\backup_02\latest\alert_history.py", line 104, in analyze_history_intent
    prompt_embedding = self._get_embeddings([analysis_prompt])
  File "D:\backup_02\latest\alert_history.py", line 58, in _get_embeddings
    outputs = self.model(**inputs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 942, in forward
    embedding_output = self.embeddings(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 180, in forward
    inputs_embeds = self.word_embeddings(input_ids)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
    return F.embedding(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\functional.py", line 2551, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)

2025-08-16 22:22:36,117 - __main__ - INFO - Parallel agent user_context completed
2025-08-16 22:22:36,118 - __main__ - INFO - Parallel agent alert_history completed
2025-08-16 22:22:36,119 - __main__ - INFO - Executing agent: summary with ES context
2025-08-16 22:22:36,119 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-16 22:22:36,120 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-16 22:22:36,121 - __main__ - ERROR - Error executing agent timeline: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
2025-08-16 22:22:36,121 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "D:\backup_02\latest\main_orchestrator.py", line 325, in execute_agent_with_es_context
    result = agent.analyze_timeline(alert, data_entry, prompt, other_agent_data)
  File "D:\backup_02\latest\timeline_agent.py", line 464, in analyze_timeline
    timeline_intent = self.analyze_timeline_intent(analysis_prompt)
  File "D:\backup_02\latest\timeline_agent.py", line 81, in analyze_timeline_intent
    prompt_embedding = self._get_embeddings([analysis_prompt])
  File "D:\backup_02\latest\timeline_agent.py", line 29, in _get_embeddings
    outputs = self.model(**inputs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 942, in forward
    embedding_output = self.embeddings(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 180, in forward
    inputs_embeds = self.word_embeddings(input_ids)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
    return F.embedding(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\functional.py", line 2551, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)

2025-08-16 22:22:36,121 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-16 22:45:44,811 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-16 22:45:44,811 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-16 22:45:44,811 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-16 22:45:44,814 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-16 22:45:51,444 - __main__ - INFO - Starting integrated security analysis for alert 16
2025-08-16 22:45:51,444 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-16 22:45:55,066 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-16 22:45:55,066 - __main__ - INFO - Processing files using ES Query Builder
2025-08-16 22:45:55,066 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-16 22:45:55,066 - __main__ - INFO - Selected alert: Execution of Suspicious Script
2025-08-16 22:45:55,969 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-16 22:45:55,969 - __main__ - INFO - Alert info extracted: event_ids=['352b7f93-9170-4dcb-9a10-cbbff6378ff6']
2025-08-16 22:45:55,969 - __main__ - INFO - Found matching data entry
2025-08-16 22:45:55,969 - __main__ - INFO - Loaded alert: Execution of Suspicious Script
2025-08-16 22:45:55,969 - __main__ - INFO - Generating Elasticsearch queries
2025-08-16 22:46:01,375 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-16 22:46:01,375 - __main__ - INFO - Generated queries successfully
2025-08-16 22:46:01,375 - __main__ - INFO - Generated Elasticsearch queries
2025-08-16 22:46:01,375 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-16 22:46:01,375 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-16 22:46:01,375 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-16 22:46:01,375 - __main__ - ERROR - Error executing agent user_context: 'UserContextAgent' object has no attribute 'suppress_internal_errors'
2025-08-16 22:46:01,375 - AlertHistoryAgent - ERROR - analyze_alert_history error: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
Traceback (most recent call last):
  File "D:\backup_02\latest\alert_history.py", line 65, in _get_embeddings
    outputs = self.model(**inputs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 942, in forward
    embedding_output = self.embeddings(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 180, in forward
    inputs_embeds = self.word_embeddings(input_ids)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
    return F.embedding(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\functional.py", line 2551, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\backup_02\latest\alert_history.py", line 453, in analyze_alert_history
    history_intent = self.analyze_history_intent(analysis_prompt)
  File "D:\backup_02\latest\alert_history.py", line 126, in analyze_history_intent
    prompt_embedding = self._get_embeddings([analysis_prompt])
  File "D:\backup_02\latest\alert_history.py", line 80, in _get_embeddings
    outputs = self.model(**inputs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 942, in forward
    embedding_output = self.embeddings(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 180, in forward
    inputs_embeds = self.word_embeddings(input_ids)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
    return F.embedding(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\functional.py", line 2551, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
2025-08-16 22:46:01,388 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "D:\backup_02\latest\user_context.py", line 43, in _get_embeddings
    outputs = self.model(**inputs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 942, in forward
    embedding_output = self.embeddings(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 180, in forward
    inputs_embeds = self.word_embeddings(input_ids)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
    return F.embedding(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\functional.py", line 2551, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\backup_02\latest\user_context.py", line 96, in analyze_query_intent
    prompt_embedding = self._get_embeddings([analysis_prompt])
  File "D:\backup_02\latest\user_context.py", line 47, in _get_embeddings
    if self.suppress_internal_errors:
AttributeError: 'UserContextAgent' object has no attribute 'suppress_internal_errors'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\backup_02\latest\user_context.py", line 323, in analyze_user
    intent_categories = self.analyze_query_intent(analysis_prompt)
  File "D:\backup_02\latest\user_context.py", line 122, in analyze_query_intent
    if self.suppress_internal_errors:
AttributeError: 'UserContextAgent' object has no attribute 'suppress_internal_errors'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\backup_02\latest\main_orchestrator.py", line 312, in execute_agent_with_es_context
    result = agent.analyze_user(alert, data_entry, prompt)
  File "D:\backup_02\latest\user_context.py", line 342, in analyze_user
    if self.suppress_internal_errors:
AttributeError: 'UserContextAgent' object has no attribute 'suppress_internal_errors'

2025-08-16 22:46:01,388 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-16 22:46:01,389 - __main__ - INFO - Parallel agent user_context completed
2025-08-16 22:46:01,390 - __main__ - INFO - Parallel agent alert_history completed
2025-08-16 22:46:01,390 - __main__ - INFO - Executing agent: summary with ES context
2025-08-16 22:46:01,390 - __main__ - ERROR - Error executing agent summary: 'NoneType' object has no attribute 'upper'
2025-08-16 22:46:01,392 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "D:\backup_02\latest\main_orchestrator.py", line 339, in execute_agent_with_es_context
    result = agent.compile_analysis(alert, other_results, prompt)
  File "D:\backup_02\latest\summary_agent.py", line 19, in compile_analysis
    agent_status = self._normalize_agent_labels(agent_results, included_agents)
  File "D:\backup_02\latest\summary_agent.py", line 88, in _normalize_agent_labels
    status_label, reason = self._apply_label_precedence(result, agent)
  File "D:\backup_02\latest\summary_agent.py", line 136, in _apply_label_precedence
    status_label = self._infer_from_content(result, agent_type)
  File "D:\backup_02\latest\summary_agent.py", line 162, in _infer_from_content
    threat_assessment = result.get('threat_assessment', '').upper()
AttributeError: 'NoneType' object has no attribute 'upper'

2025-08-16 22:46:01,392 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-16 22:46:01,393 - __main__ - ERROR - Error executing agent timeline: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
2025-08-16 22:46:01,394 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "D:\backup_02\latest\main_orchestrator.py", line 325, in execute_agent_with_es_context
    result = agent.analyze_timeline(alert, data_entry, prompt, other_agent_data)
  File "D:\backup_02\latest\timeline_agent.py", line 487, in analyze_timeline
    timeline_intent = self.analyze_timeline_intent(analysis_prompt)
  File "D:\backup_02\latest\timeline_agent.py", line 92, in analyze_timeline_intent
    prompt_embedding = self._get_embeddings([analysis_prompt])
  File "D:\backup_02\latest\timeline_agent.py", line 40, in _get_embeddings
    outputs = self.model(**inputs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 942, in forward
    embedding_output = self.embeddings(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 180, in forward
    inputs_embeds = self.word_embeddings(input_ids)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
    return F.embedding(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\functional.py", line 2551, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)

2025-08-16 22:46:01,394 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-16 23:06:38,449 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-16 23:06:38,449 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-16 23:06:38,449 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-16 23:06:38,449 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-16 23:06:45,779 - __main__ - INFO - Starting integrated security analysis for alert 16
2025-08-16 23:06:45,779 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-16 23:06:49,549 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-16 23:06:49,549 - __main__ - INFO - Processing files using ES Query Builder
2025-08-16 23:06:49,549 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-16 23:06:49,549 - __main__ - INFO - Selected alert: Execution of Suspicious Script
2025-08-16 23:06:50,474 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-16 23:06:50,475 - __main__ - INFO - Alert info extracted: event_ids=['352b7f93-9170-4dcb-9a10-cbbff6378ff6']
2025-08-16 23:06:50,475 - __main__ - INFO - Found matching data entry
2025-08-16 23:06:50,475 - __main__ - INFO - Loaded alert: Execution of Suspicious Script
2025-08-16 23:06:50,475 - __main__ - INFO - Generating Elasticsearch queries
2025-08-16 23:06:55,914 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-16 23:06:55,914 - __main__ - INFO - Generated queries successfully
2025-08-16 23:06:55,914 - __main__ - INFO - Generated Elasticsearch queries
2025-08-16 23:06:55,914 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-16 23:06:55,919 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-16 23:06:55,919 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-16 23:06:55,919 - __main__ - ERROR - Error executing agent user_context: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
2025-08-16 23:06:55,921 - AlertHistoryAgent - ERROR - analyze_alert_history error: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
Traceback (most recent call last):
  File "D:\backup_02\latest\alert_history.py", line 65, in _get_embeddings
    outputs = self.model(**inputs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 942, in forward
    embedding_output = self.embeddings(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 180, in forward
    inputs_embeds = self.word_embeddings(input_ids)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
    return F.embedding(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\functional.py", line 2551, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\backup_02\latest\alert_history.py", line 453, in analyze_alert_history
    history_intent = self.analyze_history_intent(analysis_prompt)
  File "D:\backup_02\latest\alert_history.py", line 126, in analyze_history_intent
    prompt_embedding = self._get_embeddings([analysis_prompt])
  File "D:\backup_02\latest\alert_history.py", line 80, in _get_embeddings
    outputs = self.model(**inputs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 942, in forward
    embedding_output = self.embeddings(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 180, in forward
    inputs_embeds = self.word_embeddings(input_ids)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
    return F.embedding(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\functional.py", line 2551, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
2025-08-16 23:06:55,921 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "D:\backup_02\latest\main_orchestrator.py", line 312, in execute_agent_with_es_context
    result = agent.analyze_user(alert, data_entry, prompt)
  File "D:\backup_02\latest\user_context.py", line 314, in analyze_user
    intent_categories = self.analyze_query_intent(analysis_prompt)
  File "D:\backup_02\latest\user_context.py", line 87, in analyze_query_intent
    prompt_embedding = self._get_embeddings([analysis_prompt])
  File "D:\backup_02\latest\user_context.py", line 34, in _get_embeddings
    outputs = self.model(**inputs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 942, in forward
    embedding_output = self.embeddings(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 180, in forward
    inputs_embeds = self.word_embeddings(input_ids)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
    return F.embedding(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\functional.py", line 2551, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)

2025-08-16 23:06:55,921 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-16 23:06:55,921 - __main__ - INFO - Parallel agent user_context completed
2025-08-16 23:06:55,921 - __main__ - INFO - Parallel agent alert_history completed
2025-08-16 23:06:55,927 - __main__ - INFO - Executing agent: summary with ES context
2025-08-16 23:06:55,927 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-16 23:06:55,927 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-16 23:07:44,926 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-16 23:07:44,926 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-16 23:16:11,149 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-16 23:16:11,149 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-16 23:16:11,150 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-16 23:16:11,150 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-16 23:16:17,554 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-16 23:16:17,554 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-16 23:16:21,658 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-16 23:16:21,659 - __main__ - INFO - Processing files using ES Query Builder
2025-08-16 23:16:21,659 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-16 23:16:21,659 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-16 23:16:22,593 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-16 23:16:22,593 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-16 23:16:22,593 - __main__ - INFO - Found matching data entry
2025-08-16 23:16:22,595 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-16 23:16:22,595 - __main__ - INFO - Generating Elasticsearch queries
2025-08-16 23:16:28,403 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-16 23:16:28,403 - __main__ - INFO - Generated queries successfully
2025-08-16 23:16:28,403 - __main__ - INFO - Generated Elasticsearch queries
2025-08-16 23:16:28,404 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-16 23:16:28,405 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-16 23:16:28,407 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-16 23:16:28,408 - IPAgent - ERROR - analyze_ip error: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
2025-08-16 23:16:28,408 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-16 23:16:28,409 - AlertHistoryAgent - ERROR - analyze_alert_history error: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
Traceback (most recent call last):
  File "D:\backup_02\latest\alert_history.py", line 65, in _get_embeddings
    outputs = self.model(**inputs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 942, in forward
    embedding_output = self.embeddings(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 180, in forward
    inputs_embeds = self.word_embeddings(input_ids)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
    return F.embedding(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\functional.py", line 2551, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\backup_02\latest\alert_history.py", line 453, in analyze_alert_history
    history_intent = self.analyze_history_intent(analysis_prompt)
  File "D:\backup_02\latest\alert_history.py", line 126, in analyze_history_intent
    prompt_embedding = self._get_embeddings([analysis_prompt])
  File "D:\backup_02\latest\alert_history.py", line 80, in _get_embeddings
    outputs = self.model(**inputs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 942, in forward
    embedding_output = self.embeddings(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\models\bert\modeling_bert.py", line 180, in forward
    inputs_embeds = self.word_embeddings(input_ids)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
    return F.embedding(
  File "C:\Users\ADMIN\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\functional.py", line 2551, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
2025-08-16 23:16:28,409 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-16 23:16:28,412 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-16 23:16:28,413 - __main__ - INFO - Parallel agent alert_history completed
2025-08-16 23:16:28,413 - __main__ - INFO - Executing agent: summary with ES context
2025-08-16 23:16:28,414 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-16 23:16:28,414 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-16 23:17:17,712 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-16 23:17:17,712 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-16 23:21:47,314 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-16 23:21:47,314 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-16 23:21:47,314 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-16 23:21:47,314 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-16 23:21:51,208 - UserContextAgent - INFO - Using device for embedding: cuda
2025-08-16 23:21:54,129 - AlertHistoryAgent - INFO - Using device for embedding: cuda
2025-08-16 23:21:54,131 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-16 23:21:54,131 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-16 23:21:57,691 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-16 23:21:57,692 - __main__ - INFO - Processing files using ES Query Builder
2025-08-16 23:21:57,692 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-16 23:21:57,692 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-16 23:21:58,540 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-16 23:21:58,540 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-16 23:21:58,540 - __main__ - INFO - Found matching data entry
2025-08-16 23:21:58,540 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-16 23:21:58,541 - __main__ - INFO - Generating Elasticsearch queries
2025-08-16 23:22:03,885 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-16 23:22:03,885 - __main__ - INFO - Generated queries successfully
2025-08-16 23:22:03,885 - __main__ - INFO - Generated Elasticsearch queries
2025-08-16 23:22:03,886 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-16 23:22:03,887 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-16 23:22:03,887 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-16 23:22:03,889 - IPAgent - ERROR - analyze_ip error: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
2025-08-16 23:22:03,889 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-16 23:22:03,889 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-16 23:23:09,464 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-16 23:23:09,466 - __main__ - INFO - Parallel agent alert_history completed
2025-08-16 23:23:09,476 - __main__ - INFO - Executing agent: summary with ES context
2025-08-16 23:23:09,481 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-16 23:23:09,501 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-16 23:23:59,226 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-16 23:23:59,228 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-17 00:14:52,100 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 00:14:52,101 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-17 00:14:52,101 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 00:14:52,101 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-17 00:14:56,153 - UserContextAgent - INFO - Using device for embedding: cuda
2025-08-17 00:14:58,907 - AlertHistoryAgent - INFO - Using device for embedding: cuda
2025-08-17 00:14:58,913 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-17 00:14:58,913 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-17 00:15:02,857 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-17 00:15:02,857 - __main__ - INFO - Processing files using ES Query Builder
2025-08-17 00:15:02,857 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-17 00:15:02,857 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-17 00:15:03,798 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-17 00:15:03,798 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-17 00:15:03,798 - __main__ - INFO - Found matching data entry
2025-08-17 00:15:03,798 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-17 00:15:03,798 - __main__ - INFO - Generating Elasticsearch queries
2025-08-17 00:15:09,137 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-17 00:15:09,137 - __main__ - INFO - Generated queries successfully
2025-08-17 00:15:09,143 - __main__ - INFO - Generated Elasticsearch queries
2025-08-17 00:15:09,143 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-17 00:15:09,143 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-17 00:15:09,143 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-17 00:16:14,517 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-17 00:16:14,518 - __main__ - INFO - Parallel agent alert_history completed
2025-08-17 00:16:14,533 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-17 00:16:14,537 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-17 00:16:14,538 - __main__ - INFO - Executing agent: summary with ES context
2025-08-17 00:16:14,546 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-17 00:16:14,546 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-17 00:17:03,706 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-17 00:17:03,706 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-17 00:21:08,201 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 00:21:08,201 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-17 00:21:08,201 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 00:21:08,201 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-17 00:21:11,762 - UserContextAgent - INFO - Using device for embedding: cuda
2025-08-17 00:21:14,476 - AlertHistoryAgent - INFO - Using device for embedding: cuda
2025-08-17 00:21:14,480 - __main__ - INFO - Starting integrated security analysis for alert 12
2025-08-17 00:21:14,480 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-17 00:21:18,541 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-17 00:21:18,541 - __main__ - INFO - Processing files using ES Query Builder
2025-08-17 00:21:18,541 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-17 00:21:18,541 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-17 00:21:19,435 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-17 00:21:19,435 - __main__ - INFO - Alert info extracted: event_ids=['12345cf6-f93d-40b2-a224-e9081c80e2c6']
2025-08-17 00:21:19,435 - __main__ - INFO - Found matching data entry
2025-08-17 00:21:19,435 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-17 00:21:19,435 - __main__ - INFO - Generating Elasticsearch queries
2025-08-17 00:21:25,014 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-17 00:21:25,014 - __main__ - INFO - Generated queries successfully
2025-08-17 00:21:25,014 - __main__ - INFO - Generated Elasticsearch queries
2025-08-17 00:21:25,014 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-17 00:21:25,014 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-17 00:21:25,014 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-17 00:21:30,178 - UserContextAgent - INFO - Dispatching ES Query: intent=authentication analysis | prompt=Analyze authentication patterns and login behavior for user jdoe on host host-101 in domain CORP from IP 192.168.1.101 including successes and failures.
Relevant Event IDs: 4625 (An account failed to log on), 4648 (A logon was attempted using explicit credentials), 4723 (An attempt was made to change an account's password), 4724 (An attempt was made to reset an accounts password), 4624 (An account was successfully logged on) | analysis_prompt=Alert: Failed Logon from Unknown Host (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: analyze failed authentication attempts
2025-08-17 00:21:34,263 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000016915A67190>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 00:21:38,331 - UserContextAgent - INFO - Dispatching ES Query: intent=activity analysis | prompt=Find all user activities and behavioral patterns for jdoe on host host-101 in domain CORP from IP 192.168.1.101 to identify anomalies.
Relevant Event IDs: 4625 (An account failed to log on), 4648 (A logon was attempted using explicit credentials), 4723 (An attempt was made to change an account's password), 4724 (An attempt was made to reset an accounts password), 4624 (An account was successfully logged on) | analysis_prompt=Alert: Failed Logon from Unknown Host (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: analyze failed authentication attempts
2025-08-17 00:21:42,399 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000016915A89150>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 00:21:46,458 - UserContextAgent - INFO - Dispatching ES Query: intent=privilege analysis | prompt=Investigate privilege changes and access modifications for user jdoe on host host-101 in domain CORP from IP 192.168.1.101.
Relevant Event IDs: 4625 (An account failed to log on), 4648 (A logon was attempted using explicit credentials), 4723 (An attempt was made to change an account's password), 4724 (An attempt was made to reset an accounts password), 4624 (An account was successfully logged on) | analysis_prompt=Alert: Failed Logon from Unknown Host (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: analyze failed authentication attempts
2025-08-17 00:21:50,551 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000016915A88160>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 00:21:54,608 - UserContextAgent - INFO - Dispatching ES Query: intent=temporal analysis | prompt=Analyze time-based patterns and schedule anomalies for user jdoe on host host-101 in domain CORP from IP 192.168.1.101.
Relevant Event IDs: 4625 (An account failed to log on), 4648 (A logon was attempted using explicit credentials), 4723 (An attempt was made to change an account's password), 4724 (An attempt was made to reset an accounts password), 4624 (An account was successfully logged on) | analysis_prompt=Alert: Failed Logon from Unknown Host (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: analyze failed authentication attempts
2025-08-17 00:21:58,674 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000016915A677F0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 00:22:02,731 - UserContextAgent - INFO - Dispatching ES Query: intent=account analysis | prompt=Find account modifications and changes for user jdoe on host host-101 in domain CORP from IP 192.168.1.101.
Relevant Event IDs: 4625 (An account failed to log on), 4648 (A logon was attempted using explicit credentials), 4723 (An attempt was made to change an account's password), 4724 (An attempt was made to reset an accounts password), 4624 (An account was successfully logged on) | analysis_prompt=Alert: Failed Logon from Unknown Host (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: analyze failed authentication attempts
2025-08-17 00:22:06,787 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000016915A67880>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 00:22:10,885 - UserContextAgent - INFO - Dispatching ES Query: intent=network analysis | prompt=Investigate network behavior and remote access patterns for user jdoe on host host-101 in domain CORP from IP 192.168.1.101.
Relevant Event IDs: 4625 (An account failed to log on), 4648 (A logon was attempted using explicit credentials), 4723 (An attempt was made to change an account's password), 4724 (An attempt was made to reset an accounts password), 4624 (An account was successfully logged on) | analysis_prompt=Alert: Failed Logon from Unknown Host (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: analyze failed authentication attempts
2025-08-17 00:22:14,923 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000016915A886D0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 00:22:18,995 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-17 00:22:18,995 - __main__ - INFO - Parallel agent user_context completed
2025-08-17 00:22:30,173 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-17 00:22:30,173 - __main__ - INFO - Parallel agent alert_history completed
2025-08-17 00:22:30,173 - __main__ - INFO - Executing agent: summary with ES context
2025-08-17 00:22:30,173 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-17 00:22:30,173 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-17 00:23:19,292 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-17 00:23:19,292 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-17 01:01:33,766 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 01:01:33,766 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-17 01:01:33,766 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 01:01:33,768 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-17 01:01:38,283 - UserContextAgent - INFO - Using device for embedding: cuda
2025-08-17 01:01:41,473 - AlertHistoryAgent - INFO - Using device for embedding: cuda
2025-08-17 01:01:41,484 - __main__ - INFO - Starting integrated security analysis for alert 16
2025-08-17 01:01:41,486 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-17 01:01:45,423 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-17 01:01:45,423 - __main__ - INFO - Processing files using ES Query Builder
2025-08-17 01:01:45,423 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-17 01:01:45,423 - __main__ - INFO - Selected alert: Execution of Suspicious Script
2025-08-17 01:01:46,558 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-17 01:01:46,558 - __main__ - INFO - Alert info extracted: event_ids=['352b7f93-9170-4dcb-9a10-cbbff6378ff6']
2025-08-17 01:01:46,559 - __main__ - INFO - Found matching data entry
2025-08-17 01:01:46,559 - __main__ - INFO - Loaded alert: Execution of Suspicious Script
2025-08-17 01:01:46,559 - __main__ - INFO - Generating Elasticsearch queries
2025-08-17 01:01:52,163 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-17 01:01:52,163 - __main__ - INFO - Generated queries successfully
2025-08-17 01:01:52,163 - __main__ - INFO - Generated Elasticsearch queries
2025-08-17 01:01:52,163 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-17 01:01:52,165 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-17 01:01:52,165 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-17 01:01:57,857 - UserContextAgent - INFO - Dispatching ES Query: intent=authentication analysis | prompt=Analyze authentication patterns and login behavior for user jdoe on host host-105 in domain CORP from IP 192.168.1.105 including successes and failures.
Relevant Event IDs: 4738 (A user account was changed), 4723 (An attempt was made to change an account's password), 4740 (A user account was locked out), 4720 (A user account was created), 4724 (An attempt was made to reset an accounts password) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: check if any other user login into this system
2025-08-17 01:02:01,935 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001D97EF642B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 01:02:06,031 - UserContextAgent - INFO - Dispatching ES Query: intent=activity analysis | prompt=Find all user activities and behavioral patterns for jdoe on host host-105 in domain CORP from IP 192.168.1.105 to identify anomalies.
Relevant Event IDs: 4738 (A user account was changed), 4723 (An attempt was made to change an account's password), 4740 (A user account was locked out), 4720 (A user account was created), 4724 (An attempt was made to reset an accounts password) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: check if any other user login into this system
2025-08-17 01:02:10,088 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001D97EF66230>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 01:02:14,139 - UserContextAgent - INFO - Dispatching ES Query: intent=privilege analysis | prompt=Investigate privilege changes and access modifications for user jdoe on host host-105 in domain CORP from IP 192.168.1.105.
Relevant Event IDs: 4738 (A user account was changed), 4723 (An attempt was made to change an account's password), 4740 (A user account was locked out), 4720 (A user account was created), 4724 (An attempt was made to reset an accounts password) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: check if any other user login into this system
2025-08-17 01:02:18,218 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001D97EF64040>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 01:02:22,253 - UserContextAgent - INFO - Dispatching ES Query: intent=temporal analysis | prompt=Analyze time-based patterns and schedule anomalies for user jdoe on host host-105 in domain CORP from IP 192.168.1.105.
Relevant Event IDs: 4738 (A user account was changed), 4723 (An attempt was made to change an account's password), 4740 (A user account was locked out), 4720 (A user account was created), 4724 (An attempt was made to reset an accounts password) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: check if any other user login into this system
2025-08-17 01:02:26,296 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001D97EF64580>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 01:02:30,355 - UserContextAgent - INFO - Dispatching ES Query: intent=account analysis | prompt=Find account modifications and changes for user jdoe on host host-105 in domain CORP from IP 192.168.1.105.
Relevant Event IDs: 4738 (A user account was changed), 4723 (An attempt was made to change an account's password), 4740 (A user account was locked out), 4720 (A user account was created), 4724 (An attempt was made to reset an accounts password) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: check if any other user login into this system
2025-08-17 01:02:34,443 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001D97EF40250>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 01:02:38,490 - UserContextAgent - INFO - Dispatching ES Query: intent=network analysis | prompt=Investigate network behavior and remote access patterns for user jdoe on host host-105 in domain CORP from IP 192.168.1.105.
Relevant Event IDs: 4738 (A user account was changed), 4723 (An attempt was made to change an account's password), 4740 (A user account was locked out), 4720 (A user account was created), 4724 (An attempt was made to reset an accounts password) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: check if any other user login into this system
2025-08-17 01:02:42,565 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001D97EF657B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 01:02:46,647 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-17 01:02:46,648 - __main__ - INFO - Parallel agent user_context completed
2025-08-17 01:02:57,404 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-17 01:02:57,405 - __main__ - INFO - Parallel agent alert_history completed
2025-08-17 01:02:57,406 - __main__ - INFO - Executing agent: summary with ES context
2025-08-17 01:02:57,407 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-17 01:02:57,408 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-17 01:03:46,782 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-17 01:03:46,782 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-17 01:08:31,580 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 01:08:31,580 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-17 01:08:31,580 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 01:08:31,581 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-17 01:08:36,301 - UserContextAgent - INFO - Using device for embedding: cuda
2025-08-17 01:08:38,908 - AlertHistoryAgent - INFO - Using device for embedding: cuda
2025-08-17 01:08:38,908 - __main__ - INFO - Starting integrated security analysis for alert 15
2025-08-17 01:08:38,911 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-17 01:08:42,611 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-17 01:08:42,611 - __main__ - INFO - Processing files using ES Query Builder
2025-08-17 01:08:42,611 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-17 01:08:42,611 - __main__ - INFO - Selected alert: Failed Logon from Unknown Host
2025-08-17 01:08:43,541 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-17 01:08:43,541 - __main__ - INFO - Alert info extracted: event_ids=['c0e932ba-10d3-44c6-a013-b0305644e608']
2025-08-17 01:08:43,541 - __main__ - INFO - Found matching data entry
2025-08-17 01:08:43,541 - __main__ - INFO - Loaded alert: Failed Logon from Unknown Host
2025-08-17 01:08:43,541 - __main__ - INFO - Generating Elasticsearch queries
2025-08-17 01:08:48,867 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-17 01:08:48,867 - __main__ - INFO - Generated queries successfully
2025-08-17 01:08:48,867 - __main__ - INFO - Generated Elasticsearch queries
2025-08-17 01:08:48,867 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-17 01:08:48,867 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-17 01:08:48,871 - __main__ - INFO - Executing agent: ip_agent with ES context
2025-08-17 01:09:54,205 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-17 01:09:54,205 - __main__ - INFO - Parallel agent alert_history completed
2025-08-17 01:09:54,337 - __main__ - INFO - Agent ip_agent completed successfully with ES context
2025-08-17 01:09:54,338 - __main__ - INFO - Parallel agent ip_agent completed
2025-08-17 01:09:54,338 - __main__ - INFO - Executing agent: summary with ES context
2025-08-17 01:09:54,338 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-17 01:09:54,338 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-17 01:10:43,278 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-17 01:10:43,278 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-17 01:15:23,842 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 01:15:23,842 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-17 01:15:23,842 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 01:15:23,842 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-17 01:15:28,581 - UserContextAgent - INFO - Using device for embedding: cuda
2025-08-17 01:15:31,395 - AlertHistoryAgent - INFO - Using device for embedding: cuda
2025-08-17 01:15:31,395 - __main__ - INFO - Starting integrated security analysis for alert 16
2025-08-17 01:15:31,395 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-17 01:15:36,074 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-17 01:15:36,075 - __main__ - INFO - Processing files using ES Query Builder
2025-08-17 01:15:36,075 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-17 01:15:36,075 - __main__ - INFO - Selected alert: Execution of Suspicious Script
2025-08-17 01:15:37,082 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-17 01:15:37,082 - __main__ - INFO - Alert info extracted: event_ids=['352b7f93-9170-4dcb-9a10-cbbff6378ff6']
2025-08-17 01:15:37,082 - __main__ - INFO - Found matching data entry
2025-08-17 01:15:37,084 - __main__ - INFO - Loaded alert: Execution of Suspicious Script
2025-08-17 01:15:37,084 - __main__ - INFO - Generating Elasticsearch queries
2025-08-17 01:15:43,221 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-17 01:15:43,221 - __main__ - INFO - Generated queries successfully
2025-08-17 01:15:43,221 - __main__ - INFO - Generated Elasticsearch queries
2025-08-17 01:15:43,222 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-17 01:15:43,223 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-17 01:15:43,224 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-17 01:15:49,674 - UserContextAgent - INFO - Dispatching ES Query: intent=authentication analysis | prompt=Analyze authentication patterns and login behavior for user jdoe on host host-105 in domain CORP from IP 192.168.1.105 including successes and failures.
Relevant Event IDs: 4738 (A user account was changed), 4723 (An attempt was made to change an account's password), 4740 (A user account was locked out), 4720 (A user account was created), 4724 (An attempt was made to reset an accounts password) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: check  if any other user login into this system
2025-08-17 01:15:53,761 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x00000248CDEB0280>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 01:15:57,844 - UserContextAgent - INFO - Dispatching ES Query: intent=activity analysis | prompt=Find all user activities and behavioral patterns for jdoe on host host-105 in domain CORP from IP 192.168.1.105 to identify anomalies.
Relevant Event IDs: 4738 (A user account was changed), 4723 (An attempt was made to change an account's password), 4740 (A user account was locked out), 4720 (A user account was created), 4724 (An attempt was made to reset an accounts password) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: check  if any other user login into this system
2025-08-17 01:16:01,923 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x00000248CDEB2200>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 01:16:06,015 - UserContextAgent - INFO - Dispatching ES Query: intent=privilege analysis | prompt=Investigate privilege changes and access modifications for user jdoe on host host-105 in domain CORP from IP 192.168.1.105.
Relevant Event IDs: 4738 (A user account was changed), 4723 (An attempt was made to change an account's password), 4740 (A user account was locked out), 4720 (A user account was created), 4724 (An attempt was made to reset an accounts password) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: check  if any other user login into this system
2025-08-17 01:16:10,134 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x00000248CDEB0190>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 01:16:14,244 - UserContextAgent - INFO - Dispatching ES Query: intent=temporal analysis | prompt=Analyze time-based patterns and schedule anomalies for user jdoe on host host-105 in domain CORP from IP 192.168.1.105.
Relevant Event IDs: 4738 (A user account was changed), 4723 (An attempt was made to change an account's password), 4740 (A user account was locked out), 4720 (A user account was created), 4724 (An attempt was made to reset an accounts password) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: check  if any other user login into this system
2025-08-17 01:16:18,351 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x00000248CDEB08B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 01:16:22,464 - UserContextAgent - INFO - Dispatching ES Query: intent=account analysis | prompt=Find account modifications and changes for user jdoe on host host-105 in domain CORP from IP 192.168.1.105.
Relevant Event IDs: 4738 (A user account was changed), 4723 (An attempt was made to change an account's password), 4740 (A user account was locked out), 4720 (A user account was created), 4724 (An attempt was made to reset an accounts password) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: check  if any other user login into this system
2025-08-17 01:16:26,578 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x00000248CDE96590>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 01:16:30,690 - UserContextAgent - INFO - Dispatching ES Query: intent=network analysis | prompt=Investigate network behavior and remote access patterns for user jdoe on host host-105 in domain CORP from IP 192.168.1.105.
Relevant Event IDs: 4738 (A user account was changed), 4723 (An attempt was made to change an account's password), 4740 (A user account was locked out), 4720 (A user account was created), 4724 (An attempt was made to reset an accounts password) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: check  if any other user login into this system
2025-08-17 01:16:34,818 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x00000248CDEB31C0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 01:16:38,941 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-17 01:16:38,942 - __main__ - INFO - Parallel agent user_context completed
2025-08-17 01:16:48,922 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-17 01:16:48,922 - __main__ - INFO - Parallel agent alert_history completed
2025-08-17 01:16:48,922 - __main__ - INFO - Executing agent: summary with ES context
2025-08-17 01:16:48,922 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-17 01:16:48,923 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-17 01:17:38,377 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-17 01:17:38,377 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-17 02:08:17,840 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 02:08:17,840 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-17 02:08:17,840 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 02:08:17,846 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-17 02:08:22,576 - UserContextAgent - INFO - Using device for embedding: cuda
2025-08-17 02:08:25,532 - AlertHistoryAgent - INFO - Using device for embedding: cuda
2025-08-17 02:08:25,534 - __main__ - INFO - Starting integrated security analysis for alert 13
2025-08-17 02:08:25,534 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-17 02:08:31,415 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-17 02:08:31,415 - __main__ - INFO - Processing files using ES Query Builder
2025-08-17 02:08:31,415 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-17 02:08:31,415 - __main__ - INFO - Selected alert: Execution of Suspicious Script
2025-08-17 02:08:32,690 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-17 02:08:32,691 - __main__ - INFO - Alert info extracted: event_ids=['002f9a72-62c4-48f4-a7f5-4361b92333ea']
2025-08-17 02:08:32,692 - __main__ - INFO - Found matching data entry
2025-08-17 02:08:32,692 - __main__ - INFO - Loaded alert: Execution of Suspicious Script
2025-08-17 02:08:32,692 - __main__ - INFO - Generating Elasticsearch queries
2025-08-17 02:08:41,831 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-17 02:08:41,831 - __main__ - INFO - Generated queries successfully
2025-08-17 02:08:41,831 - __main__ - INFO - Generated Elasticsearch queries
2025-08-17 02:08:41,831 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-17 02:08:41,831 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-17 02:08:41,831 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-17 02:08:49,995 - UserContextAgent - INFO - Dispatching ES Query: intent=authentication analysis | prompt=Analyze authentication patterns and login behavior for user jdoe on host host-102 in domain CORP from IP 192.168.1.102 including successes and failures.
Relevant Event IDs: 4723 (An attempt was made to change an account's password), 4724 (An attempt was made to reset an accounts password), 4738 (A user account was changed), 4740 (A user account was locked out), 4781 (The name of an account was changed) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: analyze failed authentication attempts
2025-08-17 02:08:54,111 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000012F82DA42B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 02:08:58,195 - UserContextAgent - INFO - Dispatching ES Query: intent=activity analysis | prompt=Find all user activities and behavioral patterns for jdoe on host host-102 in domain CORP from IP 192.168.1.102 to identify anomalies.
Relevant Event IDs: 4723 (An attempt was made to change an account's password), 4724 (An attempt was made to reset an accounts password), 4738 (A user account was changed), 4740 (A user account was locked out), 4781 (The name of an account was changed) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: analyze failed authentication attempts
2025-08-17 02:09:02,285 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000012F82DA6230>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 02:09:06,360 - UserContextAgent - INFO - Dispatching ES Query: intent=privilege analysis | prompt=Investigate privilege changes and access modifications for user jdoe on host host-102 in domain CORP from IP 192.168.1.102.
Relevant Event IDs: 4723 (An attempt was made to change an account's password), 4724 (An attempt was made to reset an accounts password), 4738 (A user account was changed), 4740 (A user account was locked out), 4781 (The name of an account was changed) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: analyze failed authentication attempts
2025-08-17 02:09:10,449 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000012F82DA4040>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 02:09:14,499 - UserContextAgent - INFO - Dispatching ES Query: intent=temporal analysis | prompt=Analyze time-based patterns and schedule anomalies for user jdoe on host host-102 in domain CORP from IP 192.168.1.102.
Relevant Event IDs: 4723 (An attempt was made to change an account's password), 4724 (An attempt was made to reset an accounts password), 4738 (A user account was changed), 4740 (A user account was locked out), 4781 (The name of an account was changed) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: analyze failed authentication attempts
2025-08-17 02:09:18,606 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000012F82DA4610>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 02:09:22,685 - UserContextAgent - INFO - Dispatching ES Query: intent=account analysis | prompt=Find account modifications and changes for user jdoe on host host-102 in domain CORP from IP 192.168.1.102.
Relevant Event IDs: 4723 (An attempt was made to change an account's password), 4724 (An attempt was made to reset an accounts password), 4738 (A user account was changed), 4740 (A user account was locked out), 4781 (The name of an account was changed) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: analyze failed authentication attempts
2025-08-17 02:09:26,760 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000012F82D82260>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 02:09:30,854 - UserContextAgent - INFO - Dispatching ES Query: intent=network analysis | prompt=Investigate network behavior and remote access patterns for user jdoe on host host-102 in domain CORP from IP 192.168.1.102.
Relevant Event IDs: 4723 (An attempt was made to change an account's password), 4724 (An attempt was made to reset an accounts password), 4738 (A user account was changed), 4740 (A user account was locked out), 4781 (The name of an account was changed) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: analyze failed authentication attempts
2025-08-17 02:09:34,940 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /generate_query (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000012F82DA71F0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-17 02:09:39,058 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-17 02:09:39,058 - __main__ - INFO - Parallel agent user_context completed
2025-08-17 02:09:47,351 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-17 02:09:47,351 - __main__ - INFO - Parallel agent alert_history completed
2025-08-17 02:09:47,353 - __main__ - INFO - Executing agent: summary with ES context
2025-08-17 02:09:47,354 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-17 02:09:47,354 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-17 02:10:37,076 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-17 02:10:37,076 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-17 03:04:09,025 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 03:04:09,025 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-17 03:04:09,025 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 03:04:09,025 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-17 03:04:14,724 - UserContextAgent - INFO - Using device for embedding: cuda
2025-08-17 03:04:17,589 - AlertHistoryAgent - INFO - Using device for embedding: cuda
2025-08-17 03:04:17,619 - __main__ - INFO - Starting integrated security analysis for alert 1
2025-08-17 03:04:17,620 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-17 03:04:24,450 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-17 03:04:24,450 - __main__ - INFO - Processing files using ES Query Builder
2025-08-17 03:04:24,450 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-17 03:04:24,450 - __main__ - INFO - Selected alert: Explicit Credential Logon Attempt
2025-08-17 03:04:25,509 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-17 03:04:25,509 - __main__ - INFO - Alert info extracted: event_ids=['b3866106-621f-4ad7-90bd-b2e2a5f0e694']
2025-08-17 03:04:25,509 - __main__ - INFO - Found matching data entry
2025-08-17 03:04:25,509 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-17 03:04:25,509 - __main__ - INFO - Generating Elasticsearch queries
2025-08-17 03:04:35,853 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-17 03:04:35,853 - __main__ - INFO - Generated queries successfully
2025-08-17 03:04:35,853 - __main__ - INFO - Generated Elasticsearch queries
2025-08-17 03:04:35,864 - __main__ - INFO - Orchestration planned: 3 agents
2025-08-17 03:04:35,864 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-17 03:05:41,593 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-17 03:05:41,595 - __main__ - INFO - Parallel agent alert_history completed
2025-08-17 03:05:41,595 - __main__ - INFO - Executing agent: summary with ES context
2025-08-17 03:05:41,603 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-17 03:05:41,603 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-17 03:06:31,368 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-17 03:06:31,368 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-17 03:11:01,365 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 03:11:01,365 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-17 03:11:01,365 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 03:11:01,365 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-17 03:11:07,586 - UserContextAgent - INFO - Using device for embedding: cuda
2025-08-17 03:11:11,251 - AlertHistoryAgent - INFO - Using device for embedding: cuda
2025-08-17 03:11:11,251 - __main__ - INFO - Starting integrated security analysis for alert 1
2025-08-17 03:11:11,251 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-17 03:11:16,832 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-17 03:11:16,832 - __main__ - INFO - Processing files using ES Query Builder
2025-08-17 03:11:16,832 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-17 03:11:16,832 - __main__ - INFO - Selected alert: Explicit Credential Logon Attempt
2025-08-17 03:11:17,982 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-17 03:11:17,982 - __main__ - INFO - Alert info extracted: event_ids=['b3866106-621f-4ad7-90bd-b2e2a5f0e694']
2025-08-17 03:11:17,982 - __main__ - INFO - Found matching data entry
2025-08-17 03:11:17,982 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-17 03:11:17,982 - __main__ - INFO - Generating Elasticsearch queries
2025-08-17 03:11:26,914 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-17 03:11:26,914 - __main__ - INFO - Generated queries successfully
2025-08-17 03:11:26,918 - __main__ - INFO - Generated Elasticsearch queries
2025-08-17 03:11:26,918 - __main__ - INFO - Orchestration planned: 3 agents
2025-08-17 03:11:26,918 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-17 03:12:32,338 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-17 03:12:32,338 - __main__ - INFO - Parallel agent alert_history completed
2025-08-17 03:12:32,338 - __main__ - INFO - Executing agent: summary with ES context
2025-08-17 03:12:32,338 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-17 03:12:32,338 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-17 03:13:22,123 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-17 03:13:22,124 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-17 03:19:54,588 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 03:19:54,588 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-17 03:19:54,588 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 03:19:54,598 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-17 03:19:59,894 - UserContextAgent - INFO - Using device for embedding: cuda
2025-08-17 03:20:03,407 - AlertHistoryAgent - INFO - Using device for embedding: cuda
2025-08-17 03:20:03,409 - __main__ - INFO - Starting integrated security analysis for alert 1
2025-08-17 03:20:03,410 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-17 03:20:09,179 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-17 03:20:09,179 - __main__ - INFO - Processing files using ES Query Builder
2025-08-17 03:20:09,179 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-17 03:20:09,179 - __main__ - INFO - Selected alert: Explicit Credential Logon Attempt
2025-08-17 03:20:10,213 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-17 03:20:10,214 - __main__ - INFO - Alert info extracted: event_ids=['b3866106-621f-4ad7-90bd-b2e2a5f0e694']
2025-08-17 03:20:10,214 - __main__ - INFO - Found matching data entry
2025-08-17 03:20:10,215 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-17 03:20:10,215 - __main__ - INFO - Generating Elasticsearch queries
2025-08-17 03:20:19,034 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-17 03:20:19,034 - __main__ - INFO - Generated queries successfully
2025-08-17 03:20:19,034 - __main__ - INFO - Generated Elasticsearch queries
2025-08-17 03:20:19,041 - __main__ - INFO - Orchestration planned: 3 agents
2025-08-17 03:20:19,044 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-17 03:21:24,502 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-17 03:21:24,502 - __main__ - INFO - Parallel agent alert_history completed
2025-08-17 03:21:24,502 - __main__ - INFO - Executing agent: summary with ES context
2025-08-17 03:21:24,502 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-17 03:21:24,507 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-17 03:22:14,174 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-17 03:22:14,174 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-17 13:11:03,131 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 13:11:03,131 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-17 13:11:03,132 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 13:11:03,133 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-17 13:11:07,915 - UserContextAgent - INFO - Using device for embedding: cuda
2025-08-17 13:11:11,015 - AlertHistoryAgent - INFO - Using device for embedding: cuda
2025-08-17 13:11:11,047 - __main__ - INFO - Starting integrated security analysis for alert 1
2025-08-17 13:11:11,047 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-17 13:11:15,191 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-17 13:11:15,200 - __main__ - INFO - Processing files using ES Query Builder
2025-08-17 13:11:15,211 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-17 13:11:15,211 - __main__ - INFO - Selected alert: Explicit Credential Logon Attempt
2025-08-17 13:11:16,337 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-17 13:11:16,337 - __main__ - INFO - Alert info extracted: event_ids=['b3866106-621f-4ad7-90bd-b2e2a5f0e694']
2025-08-17 13:11:16,337 - __main__ - INFO - Found matching data entry
2025-08-17 13:11:16,338 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-17 13:11:16,338 - __main__ - INFO - Generating Elasticsearch queries
2025-08-17 13:11:22,355 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-17 13:11:22,359 - __main__ - INFO - Generated queries successfully
2025-08-17 13:11:22,359 - __main__ - INFO - Generated Elasticsearch queries
2025-08-17 13:11:22,360 - __main__ - INFO - Orchestration planned: 3 agents
2025-08-17 13:11:22,360 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-17 13:12:27,879 - __main__ - INFO - Agent alert_history completed successfully with ES context
2025-08-17 13:12:27,879 - __main__ - INFO - Parallel agent alert_history completed
2025-08-17 13:12:27,879 - __main__ - INFO - Executing agent: summary with ES context
2025-08-17 13:12:27,879 - __main__ - INFO - Agent summary completed successfully with ES context
2025-08-17 13:12:27,879 - __main__ - INFO - Executing agent: timeline with ES context
2025-08-17 13:13:17,033 - __main__ - INFO - Agent timeline completed successfully with ES context
2025-08-17 13:13:17,033 - __main__ - INFO - Integrated security analysis completed successfully
2025-08-17 13:16:15,719 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 13:16:15,719 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-17 13:16:15,719 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 13:16:15,724 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-17 13:16:20,365 - UserContextAgent - INFO - Using device for embedding: cuda
2025-08-17 13:16:22,932 - AlertHistoryAgent - INFO - Using device for embedding: cuda
2025-08-17 13:16:22,934 - __main__ - INFO - Starting integrated security analysis for alert 1
2025-08-17 13:16:22,934 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-17 13:16:26,644 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-17 13:16:26,644 - __main__ - INFO - Processing files using ES Query Builder
2025-08-17 13:16:26,644 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-17 13:16:26,644 - __main__ - INFO - Selected alert: Explicit Credential Logon Attempt
2025-08-17 13:16:27,654 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-17 13:16:27,654 - __main__ - INFO - Alert info extracted: event_ids=['b3866106-621f-4ad7-90bd-b2e2a5f0e694']
2025-08-17 13:16:27,654 - __main__ - INFO - Found matching data entry
2025-08-17 13:16:27,654 - __main__ - INFO - Loaded alert: Explicit Credential Logon Attempt
2025-08-17 13:16:27,654 - __main__ - INFO - Generating Elasticsearch queries
2025-08-17 13:27:02,775 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 13:27:02,775 - gpu_utils - INFO - 🚀 GPU Acceleration Enabled: NVIDIA GeForce GTX 1650 (4.0GB)
2025-08-17 13:27:02,775 - gpu_utils - INFO - ⚡ Mixed Precision (AMP) Enabled
2025-08-17 13:27:02,775 - __main__ - INFO - 🚀 GPU Acceleration initialized: {'device': 'cuda:0', 'device_type': 'cuda', 'amp_enabled': True, 'gpu_name': 'NVIDIA GeForce GTX 1650', 'memory_total_gb': 3.99969482421875, 'memory_allocated_gb': 0.0, 'memory_cached_gb': 0.0}
2025-08-17 13:27:07,046 - UserContextAgent - INFO - Using device for embedding: cuda
2025-08-17 13:27:09,875 - AlertHistoryAgent - INFO - Using device for embedding: cuda
2025-08-17 13:27:09,878 - __main__ - INFO - Starting integrated security analysis for alert 16
2025-08-17 13:27:09,878 - __main__ - INFO - Initializing ES Query Builder with events file: Spharaka-Windows_Events_Filtered.json
2025-08-17 13:27:13,515 - __main__ - INFO - ES Query Builder initialized successfully
2025-08-17 13:27:13,515 - __main__ - INFO - Processing files using ES Query Builder
2025-08-17 13:27:13,515 - __main__ - INFO - Loaded 20 alerts from alerts.jsonl
2025-08-17 13:27:13,515 - __main__ - INFO - Selected alert: Execution of Suspicious Script
2025-08-17 13:27:14,520 - __main__ - INFO - Loaded 58770 data entries from data.json
2025-08-17 13:27:14,520 - __main__ - INFO - Alert info extracted: event_ids=['352b7f93-9170-4dcb-9a10-cbbff6378ff6']
2025-08-17 13:27:14,520 - __main__ - INFO - Found matching data entry
2025-08-17 13:27:14,520 - __main__ - INFO - Loaded alert: Execution of Suspicious Script
2025-08-17 13:27:14,520 - __main__ - INFO - Generating Elasticsearch queries
2025-08-17 13:27:20,106 - __main__ - INFO - Found 10 relevant events (threshold: 0.3)
2025-08-17 13:27:20,106 - __main__ - INFO - Generated queries successfully
2025-08-17 13:27:20,106 - __main__ - INFO - Generated Elasticsearch queries
2025-08-17 13:27:20,110 - __main__ - INFO - Orchestration planned: 4 agents
2025-08-17 13:27:20,110 - __main__ - INFO - Executing agent: alert_history with ES context
2025-08-17 13:27:20,110 - __main__ - INFO - Executing agent: user_context with ES context
2025-08-17 13:27:25,352 - UserContextAgent - INFO - Dispatching ES Query: intent=authentication analysis | prompt=Analyze authentication patterns and login behavior for user jdoe on host host-105 in domain CORP from IP 192.168.1.105 including successes and failures.
Relevant Event IDs: 4723 (An attempt was made to change an account's password), 4724 (An attempt was made to reset an accounts password), 4738 (A user account was changed), 4740 (A user account was locked out), 4781 (The name of an account was changed) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: analyze failed authentication attempts
2025-08-17 13:27:46,401 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='10.9.56.10', port=30200): Max retries exceeded with url: /generate_query (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001C4104474F0>, 'Connection to 10.9.56.10 timed out. (connect timeout=30)'))
2025-08-17 13:28:07,439 - UserContextAgent - INFO - Dispatching ES Query: intent=activity analysis | prompt=Find all user activities and behavioral patterns for jdoe on host host-105 in domain CORP from IP 192.168.1.105 to identify anomalies.
Relevant Event IDs: 4723 (An attempt was made to change an account's password), 4724 (An attempt was made to reset an accounts password), 4738 (A user account was changed), 4740 (A user account was locked out), 4781 (The name of an account was changed) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: analyze failed authentication attempts
2025-08-17 13:28:28,468 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='10.9.56.10', port=30200): Max retries exceeded with url: /generate_query (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001C4104479A0>, 'Connection to 10.9.56.10 timed out. (connect timeout=30)'))
2025-08-17 13:28:49,523 - UserContextAgent - INFO - Dispatching ES Query: intent=privilege analysis | prompt=Investigate privilege changes and access modifications for user jdoe on host host-105 in domain CORP from IP 192.168.1.105.
Relevant Event IDs: 4723 (An attempt was made to change an account's password), 4724 (An attempt was made to reset an accounts password), 4738 (A user account was changed), 4740 (A user account was locked out), 4781 (The name of an account was changed) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: analyze failed authentication attempts
2025-08-17 13:29:10,598 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='10.9.56.10', port=30200): Max retries exceeded with url: /generate_query (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001C4104313F0>, 'Connection to 10.9.56.10 timed out. (connect timeout=30)'))
2025-08-17 13:29:31,637 - UserContextAgent - INFO - Dispatching ES Query: intent=temporal analysis | prompt=Analyze time-based patterns and schedule anomalies for user jdoe on host host-105 in domain CORP from IP 192.168.1.105.
Relevant Event IDs: 4723 (An attempt was made to change an account's password), 4724 (An attempt was made to reset an accounts password), 4738 (A user account was changed), 4740 (A user account was locked out), 4781 (The name of an account was changed) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: analyze failed authentication attempts
2025-08-17 13:29:52,691 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='10.9.56.10', port=30200): Max retries exceeded with url: /generate_query (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001C410447F70>, 'Connection to 10.9.56.10 timed out. (connect timeout=30)'))
2025-08-17 13:30:13,724 - UserContextAgent - INFO - Dispatching ES Query: intent=account analysis | prompt=Find account modifications and changes for user jdoe on host host-105 in domain CORP from IP 192.168.1.105.
Relevant Event IDs: 4723 (An attempt was made to change an account's password), 4724 (An attempt was made to reset an accounts password), 4738 (A user account was changed), 4740 (A user account was locked out), 4781 (The name of an account was changed) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: analyze failed authentication attempts
2025-08-17 13:30:34,759 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='10.9.56.10', port=30200): Max retries exceeded with url: /generate_query (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001C410444040>, 'Connection to 10.9.56.10 timed out. (connect timeout=30)'))
2025-08-17 13:30:55,807 - UserContextAgent - INFO - Dispatching ES Query: intent=network analysis | prompt=Investigate network behavior and remote access patterns for user jdoe on host host-105 in domain CORP from IP 192.168.1.105.
Relevant Event IDs: 4723 (An attempt was made to change an account's password), 4724 (An attempt was made to reset an accounts password), 4738 (A user account was changed), 4740 (A user account was locked out), 4781 (The name of an account was changed) | analysis_prompt=Alert: Execution of Suspicious Script (Severity: high). Analyze user behavior, authentication patterns, and account activities. Task: analyze failed authentication attempts
2025-08-17 13:31:16,855 - UserContextAgent - ERROR - ES Query dispatch failed: HTTPConnectionPool(host='10.9.56.10', port=30200): Max retries exceeded with url: /generate_query (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001C410432350>, 'Connection to 10.9.56.10 timed out. (connect timeout=30)'))
2025-08-17 13:31:37,885 - __main__ - INFO - Agent user_context completed successfully with ES context
2025-08-17 13:32:56,953 - __main__ - INFO - Agent alert_history completed successfully with ES context
